<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ†æç”Ÿæˆ - TOP_N æ¨å¹¿å¹³å°</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/css/design-system.css">
    <link rel="stylesheet" href="/static/css/page-header.css">
    <!-- Quill å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ -->
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/article-editor.css">
    <style>
        /* ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤ºæ ·å¼ */
        #user-info-display {
            min-width: 120px;
        }

        .user-info-container {
            position: relative;
            display: inline-block;
        }

        .user-info-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            font-size: 14px;
        }

        .user-info-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .user-icon {
            font-size: 1.1rem;
        }

        .user-name {
            font-weight: 600;
        }

        .dropdown-arrow {
            font-size: 0.7rem;
            margin-left: 4px;
        }

        .user-menu {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            min-width: 200px;
            z-index: 1000;
        }

        .user-menu-item {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #333;
            text-decoration: none;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 0.95rem;
        }

        .user-menu-item:hover {
            background: #f8f9fa;
        }

        .user-menu-item.user-menu-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 4px;
            cursor: default;
        }

        .user-menu-item.user-menu-header:hover {
            background: none;
        }

        .user-menu-divider {
            height: 1px;
            background: #e9ecef;
            margin: 4px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header style="position: relative;">
            <h1>ğŸš€ TOP_N æ¨å¹¿å¹³å°</h1>
            <p class="subtitle">è®©æ‚¨çš„å…¬å¸åœ¨å¤§æ¨¡å‹æ¨èä¸­æ’åé å‰</p>
            <div style="position: absolute; top: 20px; right: 20px;">
                <div id="user-info-display"></div>
            </div>
        </header>

        <main>
            <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
            <div class="steps">
                <div class="step active" id="step1">
                    <div class="step-number">1</div>
                    <div class="step-title">è¾“å…¥ä¿¡æ¯</div>
                </div>
                <div class="step active" id="step2">
                    <div class="step-number">2</div>
                    <div class="step-title">åˆ†æç”Ÿæˆ</div>
                </div>
                <div class="step" id="step3">
                    <div class="step-number">3</div>
                    <div class="step-title">å‘å¸ƒæ¨å¹¿</div>
                </div>
            </div>

            <!-- åˆ†æç»“æœ -->
            <section id="analysis-section" class="section active">
                <h2>ğŸ“Š æ™ºèƒ½åˆ†æç»“æœ</h2>

                <!-- åˆ†æç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
                <div class="analysis-card" id="analysis-card">
                    <div class="analysis-header">
                        <span class="analysis-label">AIåˆ†ææŠ¥å‘Š</span>
                        <button class="btn-icon btn-edit" id="edit-analysis-btn" title="ç¼–è¾‘åˆ†æç»“æœ">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                        </button>
                    </div>

                    <!-- æ˜¾ç¤ºæ¨¡å¼ -->
                    <div id="analysis-display" class="result-box"></div>

                    <!-- ç¼–è¾‘æ¨¡å¼ -->
                    <div id="analysis-editor-container" class="editor-container" style="display: none;">
                        <div id="analysis-toolbar">
                            <span class="ql-formats">
                                <select class="ql-header">
                                    <option value="1">æ ‡é¢˜1</option>
                                    <option value="2">æ ‡é¢˜2</option>
                                    <option value="3">æ ‡é¢˜3</option>
                                    <option selected>æ­£æ–‡</option>
                                </select>
                            </span>
                            <span class="ql-formats">
                                <button class="ql-bold"></button>
                                <button class="ql-italic"></button>
                                <button class="ql-underline"></button>
                            </span>
                            <span class="ql-formats">
                                <select class="ql-color"></select>
                                <select class="ql-background"></select>
                            </span>
                            <span class="ql-formats">
                                <button class="ql-list" value="ordered"></button>
                                <button class="ql-list" value="bullet"></button>
                            </span>
                            <span class="ql-formats">
                                <button class="ql-blockquote"></button>
                            </span>
                            <span class="ql-formats">
                                <button class="ql-clean"></button>
                            </span>
                        </div>
                        <div id="analysis-editor"></div>
                    </div>

                    <!-- ç¼–è¾‘æ“ä½œæŒ‰é’® -->
                    <div id="analysis-edit-actions" class="edit-actions" style="display: none;">
                        <button class="btn btn-secondary btn-sm" id="cancel-analysis-edit">å–æ¶ˆ</button>
                        <button class="btn btn-primary btn-sm" id="save-analysis-edit">ä¿å­˜ä¿®æ”¹</button>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="WorkflowNav.goToInput()">è¿”å›ä¿®æ”¹</button>
                    <div class="form-group" style="margin-bottom: 20px;">
                        <label for="ai-model-select">AIæ¨¡å‹é€‰æ‹©:</label>
                        <select id="ai-model-select" name="ai_model" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="">åŠ è½½ä¸­...</option>
                        </select>
                        <small style="color: #666; display: block; margin-top: 5px;">é€‰æ‹©ç”¨äºç”Ÿæˆæ–‡ç« çš„AIæ¨¡å‹,é»˜è®¤ä¸ºé€šä¹‰åƒé—®Plus</small>
                    </div>
                    <button class="btn btn-primary" id="generate-btn">ç”Ÿæˆæ¨å¹¿æ–‡ç« </button>
                </div>
            </section>

            <!-- åŠ è½½åŠ¨ç”» -->
            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p id="loading-text">æ­£åœ¨å¤„ç†ä¸­...</p>
            </div>
        </main>

        <footer>
            <p>Â© 2024 TOP_N Platform - è®©æ‚¨çš„å“ç‰Œåœ¨AIæ—¶ä»£è„±é¢–è€Œå‡º</p>
        </footer>
    </div>

    <script src="/static/state.js"></script>
    <script src="/static/js/common.js"></script>
    <script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
    <script src="/static/analysis.js"></script>
    <script src="/static/user_display.js"></script>
</body>
</html>
