<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†æ§åˆ¶å° - TOP_N ä¼ä¸šçº§ç®¡ç†å¹³å°</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ“Š</text></svg>">
    <link rel="stylesheet" href="/static/css/design-system.css">
    <link rel="stylesheet" href="/static/css/page-header.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ç®¡ç†æ§åˆ¶å°ä¸“ç”¨æ ·å¼ */
        .admin-dashboard {
            display: flex;
            min-height: 100vh;
            background: #f8fafc;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .admin-sidebar {
            width: 280px;
            background: linear-gradient(180deg, #1e293b 0%, #334155 100%);
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .admin-sidebar-header {
            padding: 0 20px 30px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
        }

        .admin-sidebar-header h2 {
            font-size: 1.5rem;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-sidebar-header .subtitle {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 5px;
        }

        .back-to-home-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.1);
            border-radius: 6px;
            color: rgba(255,255,255,0.9);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .back-to-home-link:hover {
            background: rgba(255,255,255,0.2);
            color: white;
            transform: translateX(-2px);
        }

        .admin-nav {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .admin-nav-item {
            margin-bottom: 2px;
        }

        .admin-nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .admin-nav-link:hover,
        .admin-nav-link.active {
            background: rgba(255,255,255,0.1);
            color: white;
            border-left-color: #3b82f6;
        }

        .admin-nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .admin-nav-badge {
            background: #ef4444;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: auto;
        }

        .admin-main {
            flex: 1;
            margin-left: 280px;
            padding: 20px;
        }

        .admin-header {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-header-left h1 {
            font-size: 2rem;
            color: #1e293b;
            margin: 0;
        }

        .admin-header-left p {
            color: #64748b;
            margin: 5px 0 0 0;
        }

        .admin-header-actions {
            display: flex;
            gap: 12px;
        }

        .admin-btn {
            padding: 10px 16px;
            border-radius: 8px;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-btn-primary {
            background: #3b82f6;
            color: white;
        }

        .admin-btn-primary:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .admin-btn-secondary {
            background: #f1f5f9;
            color: #475569;
        }

        .admin-btn-secondary:hover {
            background: #e2e8f0;
        }

        .admin-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .admin-stat-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }

        .admin-stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        }

        .admin-stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .admin-stat-title {
            color: #64748b;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .admin-stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .admin-stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 8px;
        }

        .admin-stat-change {
            font-size: 0.85rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .admin-stat-change.positive {
            color: #10b981;
        }

        .admin-stat-change.negative {
            color: #ef4444;
        }

        .admin-content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        /* å›¾è¡¨å®¹å™¨æ ·å¼ */
        .chart-container {
            position: relative;
            height: 320px;
            padding: 16px 0;
        }

        .chart-container canvas {
            transition: opacity 0.3s ease;
        }

        .chart-container .admin-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }

        @media (max-width: 1200px) {
            .admin-content-grid {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 280px;
            }
        }

        @media (max-width: 768px) {
            .chart-container {
                height: 240px;
                padding: 12px 0;
            }

            .admin-card {
                padding: 16px;
            }

            .admin-card-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .admin-card-actions {
                width: 100%;
                justify-content: flex-start;
            }
        }

        .admin-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .admin-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e5e7eb;
        }

        .admin-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
        }

        .admin-card-actions {
            display: flex;
            gap: 8px;
        }

        .admin-card-action {
            padding: 6px 12px;
            font-size: 0.8rem;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
            background: white;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-card-action:hover {
            background: #f8fafc;
            border-color: #3b82f6;
            color: #3b82f6;
        }

        .admin-card-action.active-period {
            background: #3b82f6;
            border-color: #3b82f6;
            color: white;
            font-weight: 600;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
        }

        .admin-table th {
            background: #f8fafc;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #475569;
            font-size: 0.85rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .admin-table td {
            padding: 16px 12px;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.9rem;
        }

        .admin-table tr:hover td {
            background: #f8fafc;
        }

        .admin-status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .admin-status-online {
            background: #dcfce7;
            color: #166534;
        }

        .admin-status-offline {
            background: #fee2e2;
            color: #991b1b;
        }

        .admin-status-warning {
            background: #fef3c7;
            color: #92400e;
        }

        .admin-alert {
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .admin-alert-info {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            color: #1e40af;
        }

        .admin-alert-warning {
            background: #fffbeb;
            border: 1px solid #fde047;
            color: #a16207;
        }

        .admin-alert-error {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #b91c1c;
        }

        .admin-progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin: 8px 0;
        }

        .admin-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .admin-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            color: #64748b;
        }

        .admin-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .admin-empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .admin-empty-state-icon {
            font-size: 3rem;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }

        .quick-action-card {
            background: #f8fafc;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-action-card:hover {
            border-color: #3b82f6;
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .quick-action-icon {
            font-size: 2rem;
            margin-bottom: 12px;
        }

        .quick-action-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .quick-action-desc {
            font-size: 0.85rem;
            color: #64748b;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .admin-sidebar {
                transform: translateX(-100%);
                z-index: 1000;
            }

            .admin-sidebar.open {
                transform: translateX(0);
            }

            .admin-main {
                margin-left: 0;
            }

            .admin-stats-grid {
                grid-template-columns: 1fr;
            }

            .admin-header {
                flex-direction: column;
                gap: 16px;
                text-align: center;
            }
        }

        /* è¡¨å•è¾“å…¥æ ·å¼ */
        .admin-input {
            padding: 10px 14px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.9rem;
            color: #1e293b;
            background: white;
            transition: all 0.3s ease;
            min-width: 140px;
        }

        .admin-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .admin-input::placeholder {
            color: #94a3b8;
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .admin-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .admin-modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .admin-modal-content {
            position: relative;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
            width: 90%;
            max-width: 600px;
            max-height: 85vh;
            overflow: hidden;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .admin-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #e5e7eb;
            background: #f8fafc;
        }

        .admin-modal-header h3 {
            margin: 0;
            font-size: 1.2rem;
            font-weight: 600;
            color: #1e293b;
        }

        .admin-modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #64748b;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .admin-modal-close:hover {
            background: #e5e7eb;
            color: #1e293b;
        }

        .admin-modal-body {
            padding: 24px;
            overflow-y: auto;
            max-height: calc(85vh - 140px);
        }

        .admin-modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            padding: 16px 24px;
            border-top: 1px solid #e5e7eb;
            background: #f8fafc;
        }

        /* åˆ†é¡µæ ·å¼ */
        .admin-pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-top: 1px solid #e5e7eb;
            margin-top: 16px;
        }

        .admin-pagination-info {
            color: #64748b;
            font-size: 0.875rem;
        }

        .admin-pagination-buttons {
            display: flex;
            gap: 8px;
        }

        .admin-page-btn {
            padding: 8px 14px;
            border: 1px solid #e5e7eb;
            background: white;
            color: #475569;
            border-radius: 6px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-page-btn:hover:not(:disabled) {
            border-color: #3b82f6;
            color: #3b82f6;
            background: #eff6ff;
        }

        .admin-page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .admin-page-btn.active {
            background: #3b82f6;
            border-color: #3b82f6;
            color: white;
        }

        /* ç­›é€‰å·¥å…·æ æ ·å¼ */
        .admin-filter-toolbar {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            align-items: flex-end;
        }

        .admin-filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .admin-filter-label {
            font-size: 0.8rem;
            font-weight: 500;
            color: #64748b;
        }

        .admin-filter-actions {
            display: flex;
            gap: 8px;
            align-items: flex-end;
        }

        /* å‘å¸ƒçŠ¶æ€æ ·å¼ */
        .admin-status-success {
            background: #dcfce7;
            color: #166534;
        }

        .admin-status-failed {
            background: #fee2e2;
            color: #991b1b;
        }

        .admin-status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        /* æ“ä½œæŒ‰é’®ç»„ */
        .admin-action-group {
            display: flex;
            gap: 6px;
        }

        .admin-action-btn {
            padding: 6px 10px;
            font-size: 0.8rem;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
            background: white;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .admin-action-btn:hover {
            background: #f8fafc;
            border-color: #3b82f6;
            color: #3b82f6;
        }

        .admin-action-btn.primary {
            background: #3b82f6;
            border-color: #3b82f6;
            color: white;
        }

        .admin-action-btn.primary:hover {
            background: #2563eb;
        }

        /* ============================================================================
         * æ—¥å¿—ç›‘æ§æ ·å¼
         * ============================================================================ */
        .log-tabs {
            display: flex;
            gap: 0;
            background: #f8fafc;
            border-radius: 12px;
            overflow: hidden;
        }

        .log-tab {
            flex: 1;
            padding: 14px 20px;
            border: none;
            background: transparent;
            color: #64748b;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }

        .log-tab:hover {
            background: #e2e8f0;
            color: #1e293b;
        }

        .log-tab.active {
            background: white;
            color: #3b82f6;
            border-bottom-color: #3b82f6;
        }

        .log-panel {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .log-select {
            padding: 8px 12px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            background: white;
            color: #1e293b;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .log-select:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .log-input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .log-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .log-console {
            background: #1e293b;
            color: #e2e8f0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            padding: 16px;
            border-radius: 8px;
            height: 500px;
            overflow-y: auto;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .log-console::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .log-console::-webkit-scrollbar-track {
            background: #334155;
            border-radius: 4px;
        }

        .log-console::-webkit-scrollbar-thumb {
            background: #64748b;
            border-radius: 4px;
        }

        .log-line {
            padding: 4px 8px;
            border-radius: 4px;
            margin: 2px 0;
            display: flex;
            gap: 12px;
        }

        .log-line:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .log-line.DEBUG { color: #94a3b8; }
        .log-line.INFO { color: #60a5fa; }
        .log-line.WARNING { color: #fbbf24; background: rgba(251, 191, 36, 0.1); }
        .log-line.ERROR { color: #f87171; background: rgba(248, 113, 113, 0.1); }
        .log-line.CRITICAL { color: #ef4444; background: rgba(239, 68, 68, 0.15); font-weight: bold; }

        .log-timestamp {
            color: #64748b;
            white-space: nowrap;
        }

        .log-level {
            font-weight: 600;
            min-width: 70px;
        }

        .log-module {
            color: #a78bfa;
            min-width: 150px;
        }

        .log-message {
            flex: 1;
        }

        .log-status-bar {
            display: flex;
            justify-content: space-between;
            padding: 12px 16px;
            background: #f8fafc;
            border-radius: 0 0 8px 8px;
            font-size: 0.85rem;
            color: #64748b;
        }

        .log-search-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        .log-search-row {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .log-search-results {
            max-height: 600px;
            overflow-y: auto;
        }

        .log-empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .log-error-item {
            padding: 16px;
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
            transition: background 0.2s;
            border-left: 4px solid transparent;
        }

        .log-error-item:hover {
            background: #f8fafc;
        }

        .log-error-item:last-child {
            border-bottom: none;
        }

        .log-error-item.severity-critical {
            border-left-color: #991b1b;
            background: #fef2f2;
        }

        .log-error-item.severity-error {
            border-left-color: #d97706;
            background: #fffbeb;
        }

        .log-error-item.severity-warning {
            border-left-color: #ca8a04;
            background: #fefce8;
        }

        .log-error-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .error-badges {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .error-code-badge, .error-category-badge, .error-severity-badge {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .error-severity-badge.severity-critical {
            background: #991b1b;
            color: #fff;
        }

        .error-severity-badge.severity-error {
            background: #d97706;
            color: #fff;
        }

        .error-severity-badge.severity-warning {
            background: #ca8a04;
            color: #fff;
        }

        .log-error-type {
            font-weight: 600;
            color: #dc2626;
        }

        .log-error-time {
            font-size: 0.8rem;
            color: #64748b;
            white-space: nowrap;
        }

        .log-error-name {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .log-error-message {
            font-size: 0.9rem;
            color: #475569;
            word-break: break-word;
        }

        .log-error-solution {
            margin-top: 8px;
            padding: 8px 12px;
            background: #ecfdf5;
            border-radius: 6px;
            font-size: 0.85rem;
            color: #065f46;
        }

        /* é”™è¯¯åˆ†ç±»ç½‘æ ¼ */
        .error-category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 12px;
            padding: 16px;
        }

        .error-category-card {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-radius: 8px;
            gap: 12px;
        }

        .error-category-icon {
            font-size: 1.5rem;
        }

        .error-category-info {
            flex: 1;
        }

        .error-category-name {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .error-category-code {
            font-size: 0.75rem;
            color: #64748b;
            font-family: monospace;
        }

        .error-category-count {
            text-align: right;
        }

        .error-count-value {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e293b;
        }

        .error-count-percent {
            font-size: 0.75rem;
            color: #64748b;
        }

        .log-error-list, .log-slow-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .log-slow-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            border-bottom: 1px solid #f1f5f9;
        }

        .log-slow-item:last-child {
            border-bottom: none;
        }

        .log-slow-operation {
            flex: 1;
            font-size: 0.9rem;
            color: #1e293b;
        }

        .log-slow-duration {
            font-weight: 600;
            color: #dc2626;
            min-width: 80px;
            text-align: right;
        }

        .log-trace-results {
            max-height: 600px;
            overflow-y: auto;
        }

        .log-trace-item {
            padding: 12px 16px;
            border-left: 3px solid #3b82f6;
            background: #f8fafc;
            margin: 8px 0;
            border-radius: 0 8px 8px 0;
        }

        .log-trace-item.ERROR {
            border-left-color: #dc2626;
            background: #fef2f2;
        }

        .log-trace-item.WARNING {
            border-left-color: #f59e0b;
            background: #fffbeb;
        }

        .log-pagination {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 20px;
            padding: 16px;
        }

        .log-page-btn {
            padding: 8px 14px;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .log-page-btn:hover {
            border-color: #3b82f6;
            color: #3b82f6;
        }

        .log-page-btn.active {
            background: #3b82f6;
            border-color: #3b82f6;
            color: white;
        }

        .log-loading {
            text-align: center;
            padding: 40px;
            color: #64748b;
        }

        /* SSEæµçŠ¶æ€æŒ‡ç¤º */
        #logStreamBtn.streaming {
            background: #dc2626;
            color: white;
            border-color: #dc2626;
        }

        #logStreamBtn.streaming:hover {
            background: #b91c1c;
        }

        @media (max-width: 768px) {
            .log-tabs {
                flex-wrap: wrap;
            }

            .log-tab {
                flex: 1 1 50%;
                font-size: 0.85rem;
            }

            .log-search-row {
                flex-wrap: wrap;
            }

            .log-console {
                height: 350px;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <div class="admin-dashboard">
        <!-- ä¾§è¾¹å¯¼èˆªæ  -->
        <aside class="admin-sidebar" id="adminSidebar">
            <div class="admin-sidebar-header">
                <h2>
                    <span>ğŸ›ï¸</span>
                    ç®¡ç†æ§åˆ¶å°
                </h2>
                <div class="subtitle">TOP_N ä¼ä¸šçº§ç®¡ç†å¹³å°</div>
                <a href="/" class="back-to-home-link">
                    <span>â†</span>
                    <span>è¿”å›é¦–é¡µ</span>
                </a>
            </div>

            <nav>
                <ul class="admin-nav">
                    <li class="admin-nav-item">
                        <a href="#overview" class="admin-nav-link active" data-section="overview">
                            <span class="admin-nav-icon">ğŸ“Š</span>
                            <span>æ¦‚è§ˆé¢æ¿</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#users" class="admin-nav-link" data-section="users">
                            <span class="admin-nav-icon">ğŸ‘¥</span>
                            <span>ç”¨æˆ·ç®¡ç†</span>
                            <span class="admin-nav-badge" id="userCount">0</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#templates" class="admin-nav-link" data-section="templates">
                            <span class="admin-nav-icon">ğŸ“</span>
                            <span>æç¤ºè¯æ¨¡æ¿</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#workflows" class="admin-nav-link" data-section="workflows">
                            <span class="admin-nav-icon">âš™ï¸</span>
                            <span>å·¥ä½œæµç®¡ç†</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#publishing" class="admin-nav-link" data-section="publishing">
                            <span class="admin-nav-icon">ğŸ“¤</span>
                            <span>å‘å¸ƒç®¡ç†</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#analytics" class="admin-nav-link" data-section="analytics">
                            <span class="admin-nav-icon">ğŸ“ˆ</span>
                            <span>æ•°æ®åˆ†æ</span>
                            <span class="admin-nav-badge" id="analyticsCount">0</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#content-analysis" class="admin-nav-link" data-section="content-analysis">
                            <span class="admin-nav-icon">ğŸ“„</span>
                            <span>å†…å®¹åˆ†æ</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#user-behavior" class="admin-nav-link" data-section="user-behavior">
                            <span class="admin-nav-icon">ğŸ‘¤</span>
                            <span>ç”¨æˆ·è¡Œä¸º</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#publishing-performance" class="admin-nav-link" data-section="publishing-performance">
                            <span class="admin-nav-icon">ğŸ“¤</span>
                            <span>å‘å¸ƒæ•ˆæœ</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#system" class="admin-nav-link" data-section="system">
                            <span class="admin-nav-icon">ğŸ”§</span>
                            <span>ç³»ç»Ÿè®¾ç½®</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#logs" class="admin-nav-link" data-section="logs">
                            <span class="admin-nav-icon">ğŸ“‹</span>
                            <span>æ—¥å¿—ç›‘æ§</span>
                        </a>
                    </li>
                    <li class="admin-nav-item">
                        <a href="#security" class="admin-nav-link" data-section="security">
                            <span class="admin-nav-icon">ğŸ”</span>
                            <span>å®‰å…¨ä¸­å¿ƒ</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <main class="admin-main">
            <!-- é¡µé¢å¤´éƒ¨ -->
            <div class="admin-header">
                <div class="admin-header-left">
                    <h1>ç®¡ç†æ§åˆ¶å°</h1>
                    <p>ç³»ç»Ÿè¿è¡Œæ—¶é—´: <span id="systemUptime">0å¤© 0å°æ—¶ 0åˆ†é’Ÿ</span></p>
                </div>
                <div class="admin-header-actions">
                    <!-- ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º -->
                    <div id="user-info-display"></div>
                    <button class="admin-btn admin-btn-secondary" onclick="refreshDashboard()">
                        ğŸ”„ åˆ·æ–°
                    </button>
                    <button class="admin-btn admin-btn-primary" onclick="exportReport()">
                        ğŸ“Š å¯¼å‡ºæŠ¥è¡¨
                    </button>
                </div>
            </div>

            <!-- æ¦‚è§ˆé¢æ¿ -->
            <div id="overview" class="admin-section active">
                <!-- ç»Ÿè®¡å¡ç‰‡ -->
                <div class="admin-stats-grid">
                    <div class="admin-stat-card">
                        <div class="admin-stat-header">
                            <div class="admin-stat-title">æ€»ç”¨æˆ·æ•°</div>
                            <div class="admin-stat-icon" style="background: #dbeafe; color: #1e40af;">ğŸ‘¥</div>
                        </div>
                        <div class="admin-stat-value" id="totalUsers">0</div>
                        <div class="admin-stat-change positive">
                            <span>â†‘</span> 12.5%
                        </div>
                    </div>

                    <div class="admin-stat-card">
                        <div class="admin-stat-header">
                            <div class="admin-stat-title">æ´»è·ƒç”¨æˆ·</div>
                            <div class="admin-stat-icon" style="background: #dcfce7; color: #166534;">âš¡</div>
                        </div>
                        <div class="admin-stat-value" id="activeUsers">0</div>
                        <div class="admin-stat-change positive">
                            <span>â†‘</span> 8.3%
                        </div>
                    </div>

                    <div class="admin-stat-card">
                        <div class="admin-stat-header">
                            <div class="admin-stat-title">ä»Šæ—¥æ–‡ç« ç”Ÿæˆ</div>
                            <div class="admin-stat-icon" style="background: #fef3c7; color: #a16207;">ğŸ“</div>
                        </div>
                        <div class="admin-stat-value" id="todayArticles">0</div>
                        <div class="admin-stat-change positive">
                            <span>â†‘</span> 23.1%
                        </div>
                    </div>

                    <div class="admin-stat-card">
                        <div class="admin-stat-header">
                            <div class="admin-stat-title">ä»Šæ—¥å‘å¸ƒæˆåŠŸ</div>
                            <div class="admin-stat-icon" style="background: #ede9fe; color: #7c3aed;">ğŸ“¤</div>
                        </div>
                        <div class="admin-stat-value" id="todayPublishes">0</div>
                        <div class="admin-stat-change negative">
                            <span>â†“</span> 3.2%
                        </div>
                    </div>
                </div>

                <!-- å›¾è¡¨å’Œåˆ—è¡¨ -->
                <div class="admin-content-grid">
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">ğŸ“ˆ æ–‡ç« ç”Ÿæˆè¶‹åŠ¿</h3>
                            <div class="admin-card-actions">
                                <button class="admin-card-action active-period" data-period="week" onclick="changeChartPeriod('week')">å‘¨</button>
                                <button class="admin-card-action" data-period="month" onclick="changeChartPeriod('month')">æœˆ</button>
                                <button class="admin-card-action" data-period="year" onclick="changeChartPeriod('year')">å¹´</button>
                            </div>
                        </div>
                        <div class="chart-container">
                            <div id="chartLoading" class="admin-loading" style="display: none;">
                                <div class="admin-spinner"></div>
                                <p style="margin-top: 12px; color: #64748b; font-size: 0.9rem;">åŠ è½½ä¸­...</p>
                            </div>
                            <canvas id="articleChart"></canvas>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">ç³»ç»ŸçŠ¶æ€</h3>
                            <div class="admin-card-actions">
                                <button class="admin-card-action" onclick="refreshSystemStatus()">åˆ·æ–°</button>
                            </div>
                        </div>
                        <div class="admin-loading" id="systemStatusLoading">
                            <div class="admin-spinner"></div>
                        </div>
                        <div id="systemStatusContent" style="display: none;">
                            <!-- ç³»ç»ŸçŠ¶æ€å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                        </div>
                    </div>
                </div>

                <!-- å¿«é€Ÿæ“ä½œ -->
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">å¿«é€Ÿæ“ä½œ</h3>
                    </div>
                    <div class="quick-actions">
                        <div class="quick-action-card" onclick="createTemplate()">
                            <div class="quick-action-icon">ğŸ“</div>
                            <div class="quick-action-title">åˆ›å»ºæ¨¡æ¿</div>
                            <div class="quick-action-desc">æ·»åŠ æ–°çš„æç¤ºè¯æ¨¡æ¿</div>
                        </div>
                        <div class="quick-action-card" onclick="manageUsers()">
                            <div class="quick-action-icon">ğŸ‘¥</div>
                            <div class="quick-action-title">ç”¨æˆ·ç®¡ç†</div>
                            <div class="quick-action-desc">ç®¡ç†ç³»ç»Ÿç”¨æˆ·</div>
                        </div>
                        <div class="quick-action-card" onclick="viewLogs()">
                            <div class="quick-action-icon">ğŸ“‹</div>
                            <div class="quick-action-title">æŸ¥çœ‹æ—¥å¿—</div>
                            <div class="quick-action-desc">ç³»ç»Ÿè¿è¡Œæ—¥å¿—</div>
                        </div>
                        <div class="quick-action-card" onclick="systemSettings()">
                            <div class="quick-action-icon">âš™ï¸</div>
                            <div class="quick-action-title">ç³»ç»Ÿè®¾ç½®</div>
                            <div class="quick-action-desc">é…ç½®ç³»ç»Ÿå‚æ•°</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ç”¨æˆ·ç®¡ç† -->
            <div id="users" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">ç”¨æˆ·åˆ—è¡¨</h3>
                        <div class="admin-card-actions">
                            <button class="admin-card-action" onclick="addUser()">æ·»åŠ ç”¨æˆ·</button>
                            <button class="admin-card-action" onclick="exportUsers()">å¯¼å‡º</button>
                        </div>
                    </div>
                    <div class="admin-loading" id="usersLoading">
                        <div class="admin-spinner"></div>
                    </div>
                    <div id="usersContent" style="display: none;">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ç”¨æˆ·å</th>
                                    <th>é‚®ç®±</th>
                                    <th>è§’è‰²</th>
                                    <th>æ³¨å†Œæ—¶é—´</th>
                                    <th>æœ€åç™»å½•</th>
                                    <th>çŠ¶æ€</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <!-- ç”¨æˆ·æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                            </tbody>
                        </table>
                    </div>
                    <!-- åˆ†é¡µ -->
                    <div id="usersPagination" class="admin-pagination" style="display: none;">
                        <div id="usersPageInfo" class="admin-pagination-info"></div>
                        <div id="usersPageButtons" class="admin-pagination-buttons"></div>
                    </div>
                </div>
            </div>

            <!-- æ¨¡æ¿ç®¡ç† -->
            <div id="templates" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">ğŸ“ æ¨¡æ¿ç®¡ç†ç³»ç»Ÿ</h3>
                        <div class="admin-card-actions">
                            <button class="admin-card-action" onclick="window.open('/templates', '_blank')">æ‰“å¼€æ¨¡æ¿ç®¡ç†</button>
                            <button class="admin-card-action" onclick="refreshTemplatesData()">åˆ·æ–°æ•°æ®</button>
                        </div>
                    </div>

                    <!-- æ¨¡æ¿ç»Ÿè®¡å¡ç‰‡ -->
                    <div class="admin-stats-grid" style="margin-bottom: 20px;">
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">æ€»æ¨¡æ¿æ•°</div>
                                <div class="admin-stat-icon" style="background: #dbeafe; color: #1e40af;">ğŸ“</div>
                            </div>
                            <div class="admin-stat-value" id="totalTemplates">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 15.2%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">æ´»è·ƒæ¨¡æ¿</div>
                                <div class="admin-stat-icon" style="background: #dcfce7; color: #166534;">âš¡</div>
                            </div>
                            <div class="admin-stat-value" id="activeTemplates">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 8.7%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">ä»Šæ—¥ä½¿ç”¨</div>
                                <div class="admin-stat-icon" style="background: #f3e8ff; color: #1e40af;">ğŸ“Š</div>
                            </div>
                            <div class="admin-stat-value" id="todayTemplateUsage">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 22.3%
                            </div>
                        </div>
                    </div>

                    <!-- å¿«é€Ÿæ“ä½œ -->
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">å¿«é€Ÿæ“ä½œ</h3>
                        </div>
                        <div class="quick-actions">
                            <div class="quick-action-card" onclick="window.open('/templates', '_blank')">
                                <div class="quick-action-icon">ğŸ“</div>
                                <div class="quick-action-title">æ¨¡æ¿ç®¡ç†</div>
                                <div class="quick-action-desc">åˆ›å»ºå’Œç®¡ç†æç¤ºè¯æ¨¡æ¿</div>
                            </div>
                            <div class="quick-action-card" onclick="window.open('/prompts-v2', '_blank')">
                                <div class="quick-action-icon">ğŸ”§</div>
                                <div class="quick-action-title">æç¤ºè¯ç®¡ç†V2</div>
                                <div class="quick-action-desc">é«˜çº§æç¤ºè¯ç¼–è¾‘ç³»ç»Ÿ</div>
                            </div>
                            <div class="quick-action-card" onclick="window.open('/template-guide', '_blank')">
                                <div class="quick-action-icon">ğŸ“–</div>
                                <div class="quick-action-title">ä½¿ç”¨æŒ‡å—</div>
                                <div class="quick-action-desc">æŸ¥çœ‹æ¨¡æ¿ä½¿ç”¨æ–‡æ¡£</div>
                            </div>
                            <div class="quick-action-card" onclick="exportAllTemplates()">
                                <div class="quick-action-icon">ğŸ“¤</div>
                                <div class="quick-action-title">å¯¼å‡ºæ¨¡æ¿</div>
                                <div class="quick-action-desc">å¯¼å‡ºæ‰€æœ‰æ¨¡æ¿æ•°æ®</div>
                            </div>
                        </div>
                    </div>

                    <!-- æœ€è¿‘æ¨¡æ¿æ´»åŠ¨ -->
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">æœ€è¿‘æ¨¡æ¿æ´»åŠ¨</h3>
                            <div class="admin-card-actions">
                                <button class="admin-card-action" onclick="refreshTemplateActivity()">åˆ·æ–°</button>
                            </div>
                        </div>
                        <div class="admin-loading" id="templateActivityLoading">
                            <div class="admin-spinner"></div>
                        </div>
                        <div id="templateActivityContent" style="display: none;">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>æ¨¡æ¿åç§°</th>
                                        <th>æ“ä½œç±»å‹</th>
                                        <th>æ“ä½œäºº</th>
                                        <th>æ“ä½œæ—¶é—´</th>
                                        <th>çŠ¶æ€</th>
                                    </tr>
                                </thead>
                                <tbody id="templateActivityTableBody">
                                    <!-- æ¨¡æ¿æ´»åŠ¨æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- å†…åµŒæ¨¡æ¿ç®¡ç†é¡µé¢ -->
                    <div class="admin-card" style="margin-top: 20px;">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">å®Œæ•´æ¨¡æ¿ç®¡ç†</h3>
                            <div class="admin-card-actions">
                                <button class="admin-card-action" onclick="window.open('/templates', '_blank')">åœ¨æ–°çª—å£æ‰“å¼€</button>
                            </div>
                        </div>
                        <div style="background: white; border-radius: 8px; overflow: hidden; height: 800px;">
                            <iframe
                                src="/templates"
                                style="width: 100%; height: 100%; border: none; display: block;"
                                frameborder="0"
                                id="templatesIframe">
                            </iframe>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å·¥ä½œæµç®¡ç† -->
            <div id="workflows" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">âš™ï¸ å·¥ä½œæµç®¡ç†</h3>
                        <div class="admin-card-actions">
                            <button class="admin-card-action" onclick="refreshWorkflows()">åˆ·æ–°</button>
                        </div>
                    </div>
                    <div class="admin-loading" id="workflowsLoading">
                        <div class="admin-spinner"></div>
                    </div>
                    <div id="workflowsContent" style="display: none;">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>å…¬å¸åç§°</th>
                                    <th>ç”¨æˆ·</th>
                                    <th>æ–‡ç« æ•°</th>
                                    <th>çŠ¶æ€</th>
                                    <th>åˆ›å»ºæ—¶é—´</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="workflowsTableBody">
                                <!-- å·¥ä½œæµæ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                            </tbody>
                        </table>
                    </div>
                    <!-- åˆ†é¡µ -->
                    <div id="workflowsPagination" class="admin-pagination" style="display: none;">
                        <div id="workflowsPageInfo" class="admin-pagination-info"></div>
                        <div id="workflowsPageButtons" class="admin-pagination-buttons"></div>
                    </div>
                </div>
            </div>

            <div id="publishing" class="admin-section" style="display: none;">
                <!-- å‘å¸ƒç»Ÿè®¡å¡ç‰‡ -->
                <div class="admin-stats-grid" style="margin-bottom: 20px;">
                    <div class="admin-stat-card">
                        <div class="admin-stat-header">
                            <div class="admin-stat-title">æ€»å‘å¸ƒæ¬¡æ•°</div>
                            <div class="admin-stat-icon" style="background: #dbeafe; color: #1e40af;">ğŸ“Š</div>
                        </div>
                        <div class="admin-stat-value" id="publishTotalAttempts">0</div>
                        <div class="admin-stat-change positive" id="publishTotalChange">
                            <span>-</span> æœ¬å‘¨æ•°æ®
                        </div>
                    </div>

                    <div class="admin-stat-card">
                        <div class="admin-stat-header">
                            <div class="admin-stat-title">å‘å¸ƒæˆåŠŸ</div>
                            <div class="admin-stat-icon" style="background: #dcfce7; color: #166534;">âœ…</div>
                        </div>
                        <div class="admin-stat-value" id="publishSuccessCount">0</div>
                        <div class="admin-stat-change positive" id="publishSuccessChange">
                            <span>-</span> æœ¬å‘¨æ•°æ®
                        </div>
                    </div>

                    <div class="admin-stat-card">
                        <div class="admin-stat-header">
                            <div class="admin-stat-title">å‘å¸ƒå¤±è´¥</div>
                            <div class="admin-stat-icon" style="background: #fee2e2; color: #991b1b;">âŒ</div>
                        </div>
                        <div class="admin-stat-value" id="publishFailedCount">0</div>
                        <div class="admin-stat-change negative" id="publishFailedChange">
                            <span>-</span> æœ¬å‘¨æ•°æ®
                        </div>
                    </div>

                    <div class="admin-stat-card">
                        <div class="admin-stat-header">
                            <div class="admin-stat-title">æˆåŠŸç‡</div>
                            <div class="admin-stat-icon" style="background: #f3e8ff; color: #7c3aed;">ğŸ“ˆ</div>
                        </div>
                        <div class="admin-stat-value" id="publishSuccessRate">0%</div>
                        <div class="admin-stat-change positive" id="publishRateChange">
                            <span>-</span> æœ¬å‘¨æ•°æ®
                        </div>
                    </div>
                </div>

                <!-- ç­›é€‰å·¥å…·æ  -->
                <div class="admin-card" style="margin-bottom: 20px;">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">ç­›é€‰æ¡ä»¶</h3>
                        <div class="admin-card-actions">
                            <button class="admin-card-action" onclick="resetPublishFilters()">é‡ç½®</button>
                        </div>
                    </div>
                    <div class="admin-filter-toolbar">
                        <div class="admin-filter-group">
                            <label class="admin-filter-label">å¹³å°</label>
                            <select id="publishPlatformFilter" class="admin-input">
                                <option value="">å…¨éƒ¨å¹³å°</option>
                                <option value="çŸ¥ä¹">çŸ¥ä¹</option>
                                <option value="zhihu">zhihu</option>
                                <option value="CSDN">CSDN</option>
                            </select>
                        </div>
                        <div class="admin-filter-group">
                            <label class="admin-filter-label">çŠ¶æ€</label>
                            <select id="publishStatusFilter" class="admin-input">
                                <option value="">å…¨éƒ¨çŠ¶æ€</option>
                                <option value="success">æˆåŠŸ</option>
                                <option value="failed">å¤±è´¥</option>
                            </select>
                        </div>
                        <div class="admin-filter-group">
                            <label class="admin-filter-label">å¼€å§‹æ—¥æœŸ</label>
                            <input type="date" id="publishDateFrom" class="admin-input">
                        </div>
                        <div class="admin-filter-group">
                            <label class="admin-filter-label">ç»“æŸæ—¥æœŸ</label>
                            <input type="date" id="publishDateTo" class="admin-input">
                        </div>
                        <div class="admin-filter-actions">
                            <button onclick="searchPublishHistory()" class="admin-btn admin-btn-primary">æœç´¢</button>
                        </div>
                    </div>
                </div>

                <!-- å‘å¸ƒå†å²è¡¨æ ¼ -->
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">å‘å¸ƒå†å²è®°å½•</h3>
                        <div class="admin-card-actions">
                            <button class="admin-card-action" onclick="refreshPublishingData()">åˆ·æ–°</button>
                        </div>
                    </div>
                    <div class="admin-loading" id="publishingLoading" style="display: none;">
                        <div class="admin-spinner"></div>
                    </div>
                    <div id="publishingContent">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>æ–‡ç« æ ‡é¢˜</th>
                                    <th>ç”¨æˆ·</th>
                                    <th>å¹³å°</th>
                                    <th>çŠ¶æ€</th>
                                    <th>å‘å¸ƒæ—¶é—´</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="publishHistoryTableBody">
                                <tr>
                                    <td colspan="7" class="admin-empty-state" style="padding: 40px;">
                                        <div class="admin-empty-state-icon">ğŸ“¤</div>
                                        <p>æš‚æ— å‘å¸ƒè®°å½•</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- åˆ†é¡µ -->
                    <div id="publishingPagination" class="admin-pagination">
                        <div id="publishingPageInfo" class="admin-pagination-info"></div>
                        <div id="publishingPageButtons" class="admin-pagination-buttons"></div>
                    </div>
                </div>

                <!-- æ–‡ç« å†…å®¹æŸ¥çœ‹æ¨¡æ€æ¡† -->
                <div id="publishContentModal" class="admin-modal" style="display: none;">
                    <div class="admin-modal-overlay" onclick="closePublishContentModal()"></div>
                    <div class="admin-modal-content" style="max-width: 800px;">
                        <div class="admin-modal-header">
                            <h3 id="publishContentModalTitle">æ–‡ç« å†…å®¹</h3>
                            <button class="admin-modal-close" onclick="closePublishContentModal()">&times;</button>
                        </div>
                        <div class="admin-modal-body">
                            <div id="publishContentModalBody" style="white-space: pre-wrap; line-height: 1.8;"></div>
                        </div>
                        <div class="admin-modal-footer">
                            <button onclick="copyPublishContent()" class="admin-btn admin-btn-secondary">å¤åˆ¶å†…å®¹</button>
                            <button onclick="closePublishContentModal()" class="admin-btn admin-btn-primary">å…³é—­</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="analytics" class="admin-section" style="display: none;">
                <div class="admin-empty-state">
                    <div class="admin-empty-state-icon">ğŸ“ˆ</div>
                    <h3>æ•°æ®åˆ†æ</h3>
                    <p>æ•°æ®åˆ†æåŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                </div>
            </div>

            <div id="system" class="admin-section" style="display: none;">
                <div class="admin-empty-state">
                    <div class="admin-empty-state-icon">ğŸ”§</div>
                    <h3>ç³»ç»Ÿè®¾ç½®</h3>
                    <p>ç³»ç»Ÿè®¾ç½®åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                </div>
            </div>

            <div id="logs" class="admin-section" style="display: none;">
                <!-- æ—¥å¿—ç›‘æ§æ ‡ç­¾é¡µå¯¼èˆª -->
                <div class="admin-card" style="margin-bottom: 20px; padding: 0;">
                    <div class="log-tabs">
                        <button class="log-tab active" onclick="switchLogTab('realtime')">å®æ—¶æ—¥å¿—</button>
                        <button class="log-tab" onclick="switchLogTab('search')">æ—¥å¿—æœç´¢</button>
                        <button class="log-tab" onclick="switchLogTab('errors')">é”™è¯¯åˆ†æ</button>
                        <button class="log-tab" onclick="switchLogTab('performance')">æ€§èƒ½ç›‘æ§</button>
                        <button class="log-tab" onclick="switchLogTab('trace')">è¯·æ±‚è¿½è¸ª</button>
                    </div>
                </div>

                <!-- å®æ—¶æ—¥å¿—é¢æ¿ -->
                <div id="log-realtime" class="log-panel">
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">ğŸ“‹ å®æ—¶æ—¥å¿—</h3>
                            <div class="admin-card-actions">
                                <select id="logFileSelect" class="log-select" onchange="changeLogFile()">
                                    <option value="all.log">all.log</option>
                                    <option value="error.log">error.log</option>
                                    <option value="slow.log">slow.log</option>
                                    <option value="performance.log">performance.log</option>
                                </select>
                                <select id="logLevelFilter" class="log-select" onchange="filterLogLevel()">
                                    <option value="ALL">å…¨éƒ¨çº§åˆ«</option>
                                    <option value="DEBUG">DEBUG</option>
                                    <option value="INFO">INFO</option>
                                    <option value="WARNING">WARNING</option>
                                    <option value="ERROR">ERROR</option>
                                </select>
                                <button class="admin-btn admin-btn-secondary" id="logStreamBtn" onclick="toggleLogStream()">
                                    <span id="streamBtnText">â–¶ å¼€å§‹</span>
                                </button>
                                <button class="admin-btn admin-btn-secondary" onclick="clearLogConsole()">æ¸…å±</button>
                                <button class="admin-btn admin-btn-secondary" onclick="refreshLogs()">åˆ·æ–°</button>
                            </div>
                        </div>
                        <div class="log-console" id="logConsole">
                            <div class="log-loading">æ­£åœ¨åŠ è½½æ—¥å¿—...</div>
                        </div>
                        <div class="log-status-bar">
                            <span id="logStatus">å°±ç»ª</span>
                            <span id="logCount">0 æ¡æ—¥å¿—</span>
                        </div>
                    </div>
                </div>

                <!-- æ—¥å¿—æœç´¢é¢æ¿ -->
                <div id="log-search" class="log-panel" style="display: none;">
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">ğŸ” æ—¥å¿—æœç´¢</h3>
                        </div>
                        <div class="log-search-form">
                            <div class="log-search-row">
                                <input type="text" id="searchKeyword" class="log-input" placeholder="è¾“å…¥æœç´¢å…³é”®è¯ï¼ˆæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼‰">
                                <select id="searchFile" class="log-select">
                                    <option value="all.log">all.log</option>
                                    <option value="error.log">error.log</option>
                                    <option value="slow.log">slow.log</option>
                                </select>
                                <select id="searchLevel" class="log-select">
                                    <option value="ALL">å…¨éƒ¨çº§åˆ«</option>
                                    <option value="DEBUG">DEBUG</option>
                                    <option value="INFO">INFO</option>
                                    <option value="WARNING">WARNING</option>
                                    <option value="ERROR">ERROR</option>
                                </select>
                            </div>
                            <div class="log-search-row">
                                <input type="datetime-local" id="searchStartTime" class="log-input">
                                <span style="color: #64748b;">è‡³</span>
                                <input type="datetime-local" id="searchEndTime" class="log-input">
                                <button class="admin-btn admin-btn-primary" onclick="searchLogs()">æœç´¢</button>
                                <button class="admin-btn admin-btn-secondary" onclick="exportSearchResults()">å¯¼å‡º</button>
                            </div>
                        </div>
                        <div id="searchResults" class="log-search-results">
                            <div class="log-empty-state">è¾“å…¥å…³é”®è¯å¼€å§‹æœç´¢</div>
                        </div>
                        <div id="searchPagination" class="log-pagination" style="display: none;"></div>
                    </div>
                </div>

                <!-- é”™è¯¯åˆ†æé¢æ¿ -->
                <div id="log-errors" class="log-panel" style="display: none;">
                    <!-- ä¸¥é‡çº§åˆ«ç»Ÿè®¡å¡ç‰‡ -->
                    <div class="admin-stats-grid" style="grid-template-columns: repeat(4, 1fr);">
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">é”™è¯¯æ€»æ•°</div>
                                <div class="admin-stat-icon" style="background: #fee2e2; color: #991b1b;">âš ï¸</div>
                            </div>
                            <div class="admin-stat-value" id="totalErrors">0</div>
                            <div class="admin-stat-change" id="errorTrend">æœ€è¿‘24å°æ—¶</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">ä¸¥é‡é”™è¯¯</div>
                                <div class="admin-stat-icon" style="background: #7f1d1d; color: #fff;">ğŸ”´</div>
                            </div>
                            <div class="admin-stat-value" id="criticalErrors" style="color: #991b1b;">0</div>
                            <div class="admin-stat-change">CRITICALçº§åˆ«</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">ä¸€èˆ¬é”™è¯¯</div>
                                <div class="admin-stat-icon" style="background: #fef3c7; color: #92400e;">ğŸŸ </div>
                            </div>
                            <div class="admin-stat-value" id="normalErrors" style="color: #d97706;">0</div>
                            <div class="admin-stat-change">ERRORçº§åˆ«</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">è­¦å‘Š</div>
                                <div class="admin-stat-icon" style="background: #fef9c3; color: #a16207;">ğŸŸ¡</div>
                            </div>
                            <div class="admin-stat-value" id="warningErrors" style="color: #ca8a04;">0</div>
                            <div class="admin-stat-change">WARNINGçº§åˆ«</div>
                        </div>
                    </div>

                    <div class="admin-content-grid">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h3 class="admin-card-title">é”™è¯¯è¶‹åŠ¿</h3>
                                <div class="admin-card-actions">
                                    <button class="admin-card-action active-period" onclick="changeErrorPeriod(24)">24å°æ—¶</button>
                                    <button class="admin-card-action" onclick="changeErrorPeriod(72)">3å¤©</button>
                                    <button class="admin-card-action" onclick="changeErrorPeriod(168)">7å¤©</button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="errorTrendChart"></canvas>
                            </div>
                        </div>
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h3 class="admin-card-title">é”™è¯¯åˆ†ç±»åˆ†å¸ƒ</h3>
                            </div>
                            <div class="chart-container">
                                <canvas id="errorTypeChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- é”™è¯¯åˆ†ç±»æ˜ç»† -->
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">é”™è¯¯åˆ†ç±»ç»Ÿè®¡</h3>
                        </div>
                        <div id="errorCategoryStats" class="error-category-grid">
                            <div class="log-loading">åŠ è½½ä¸­...</div>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">æœ€è¿‘é”™è¯¯</h3>
                            <button class="admin-btn admin-btn-secondary" onclick="loadErrorStats()">åˆ·æ–°</button>
                        </div>
                        <div id="recentErrors" class="log-error-list">
                            <div class="log-loading">åŠ è½½ä¸­...</div>
                        </div>
                    </div>
                </div>

                <!-- æ€§èƒ½ç›‘æ§é¢æ¿ -->
                <div id="log-performance" class="log-panel" style="display: none;">
                    <div class="admin-stats-grid">
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">æ€»è¯·æ±‚æ•°</div>
                                <div class="admin-stat-icon" style="background: #dbeafe; color: #1e40af;">ğŸ“ˆ</div>
                            </div>
                            <div class="admin-stat-value" id="totalRequests">0</div>
                            <div class="admin-stat-change">æœ€è¿‘24å°æ—¶</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">å¹³å‡å“åº”æ—¶é—´</div>
                                <div class="admin-stat-icon" style="background: #dcfce7; color: #166534;">â±ï¸</div>
                            </div>
                            <div class="admin-stat-value" id="avgResponseTime2">0ms</div>
                            <div class="admin-stat-change">æ¯«ç§’</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">P95å“åº”æ—¶é—´</div>
                                <div class="admin-stat-icon" style="background: #fef3c7; color: #92400e;">ğŸ“Š</div>
                            </div>
                            <div class="admin-stat-value" id="p95ResponseTime">0ms</div>
                            <div class="admin-stat-change">95%è¯·æ±‚</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">æ…¢è¯·æ±‚æ•°</div>
                                <div class="admin-stat-icon" style="background: #fee2e2; color: #991b1b;">ğŸŒ</div>
                            </div>
                            <div class="admin-stat-value" id="slowRequests">0</div>
                            <div class="admin-stat-change">>2ç§’çš„è¯·æ±‚</div>
                        </div>
                    </div>

                    <div class="admin-content-grid">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h3 class="admin-card-title">å“åº”æ—¶é—´è¶‹åŠ¿</h3>
                                <div class="admin-card-actions">
                                    <button class="admin-card-action active-period" onclick="changePerfPeriod(24)">24å°æ—¶</button>
                                    <button class="admin-card-action" onclick="changePerfPeriod(72)">3å¤©</button>
                                    <button class="admin-card-action" onclick="changePerfPeriod(168)">7å¤©</button>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="perfTrendChart"></canvas>
                            </div>
                        </div>
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h3 class="admin-card-title">æ…¢æŸ¥è¯¢æ’è¡Œ</h3>
                                <button class="admin-btn admin-btn-secondary" onclick="loadPerformanceStats()">åˆ·æ–°</button>
                            </div>
                            <div id="slowQueryList" class="log-slow-list">
                                <div class="log-loading">åŠ è½½ä¸­...</div>
                            </div>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">ç«¯ç‚¹æ€§èƒ½æ’å</h3>
                        </div>
                        <table class="admin-table" id="endpointPerfTable">
                            <thead>
                                <tr>
                                    <th>ç«¯ç‚¹</th>
                                    <th>è¯·æ±‚æ•°</th>
                                    <th>å¹³å‡è€—æ—¶</th>
                                    <th>P95è€—æ—¶</th>
                                    <th>æœ€å¤§è€—æ—¶</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td colspan="5" class="log-loading">åŠ è½½ä¸­...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- è¯·æ±‚è¿½è¸ªé¢æ¿ -->
                <div id="log-trace" class="log-panel" style="display: none;">
                    <div class="admin-card">
                        <div class="admin-card-header">
                            <h3 class="admin-card-title">ğŸ”— è¯·æ±‚è¿½è¸ª</h3>
                        </div>
                        <div class="log-search-form">
                            <div class="log-search-row">
                                <input type="text" id="traceRequestId" class="log-input" placeholder="è¾“å…¥è¯·æ±‚IDï¼ˆå¦‚: abc12345ï¼‰" style="flex: 2;">
                                <button class="admin-btn admin-btn-primary" onclick="traceRequest()">è¿½è¸ª</button>
                            </div>
                        </div>
                        <div id="traceResults" class="log-trace-results">
                            <div class="log-empty-state">è¾“å…¥è¯·æ±‚IDè¿½è¸ªå®Œæ•´è¯·æ±‚é“¾è·¯</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ•°æ®åˆ†æ -->
            <div id="analytics" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">ğŸ“ˆ æ•°æ®åˆ†ææ¦‚è§ˆ</h3>
                        <div class="admin-card-actions">
                            <button class="admin-card-action" onclick="changeAnalysisPeriod('day')">ä»Šæ—¥</button>
                            <button class="admin-card-action" onclick="changeAnalysisPeriod('week')">æœ¬å‘¨</button>
                            <button class="admin-card-action" onclick="changeAnalysisPeriod('month')">æœ¬æœˆ</button>
                            <button class="admin-card-action" onclick="exportAnalytics()">å¯¼å‡º</button>
                        </div>
                    </div>

                    <!-- åˆ†æç»Ÿè®¡å¡ç‰‡ -->
                    <div class="admin-stats-grid">
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">ä»Šæ—¥è®¿é—®é‡</div>
                                <div class="admin-stat-icon" style="background: #dbeafe; color: #1e40af;">ğŸ‘¥</div>
                            </div>
                            <div class="admin-stat-value" id="todayVisits">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 15.3%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">æ–‡ç« ç”Ÿæˆæ•°</div>
                                <div class="admin-stat-icon" style="background: #fbbf24; color: #f59e0b;">ğŸ“</div>
                            </div>
                            <div class="admin-stat-value" id="todayArticleGeneration">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 22.7%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">å‘å¸ƒæˆåŠŸç‡</div>
                                <div class="admin-stat-icon" style="background: #dcfce7; color: #166534;">ğŸ“¤</div>
                            </div>
                            <div class="admin-stat-value" id="publishSuccessRate">0%</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 5.2%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">å¹³å‡å“åº”æ—¶é—´</div>
                                <div class="admin-stat-icon" style="background: #f3e8ff; color: #1e40af;">âš¡</div>
                            </div>
                            <div class="admin-stat-value" id="avgResponseTime">0ms</div>
                            <div class="admin-stat-change positive">
                                <span>â†“</span> 8.1%
                            </div>
                        </div>
                    </div>

                    <!-- åˆ†æå›¾è¡¨åŒºåŸŸ -->
                    <div class="admin-content-grid">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h3 class="admin-card-title">è®¿é—®é‡è¶‹åŠ¿</h3>
                                <div class="admin-card-actions">
                                    <button class="admin-card-action" onclick="changeAnalysisChart('visits')">è®¿é—®é‡</button>
                                    <button class="admin-card-action" onclick="changeAnalysisChart('usage')">ä½¿ç”¨é‡</button>
                                </div>
                            </div>
                            <div class="admin-loading" id="analysisLoading">
                                <div class="admin-spinner"></div>
                            </div>
                            <div id="analysisContent" style="display: none;">
                                <canvas id="analysisChart" width="400" height="200"></canvas>
                            </div>
                        </div>

                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h3 class="admin-card-title">çƒ­é—¨å†…å®¹</h3>
                                <div class="admin-card-actions">
                                    <button class="admin-card-action" onclick="refreshHotContent()">åˆ·æ–°</button>
                                </div>
                            </div>
                            <div class="admin-loading" id="hotContentLoading">
                                <div class="admin-spinner"></div>
                            </div>
                            <div id="hotContentContent" style="display: none;">
                                <!-- çƒ­é—¨å†…å®¹å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å†…å®¹åˆ†æ -->
            <div id="content-analysis" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">ğŸ“„ å†…å®¹åˆ†æ</h3>
                        <div class="admin-card-actions">
                            <button class="admin-card-action" onclick="changeContentPeriod('week')">æœ¬å‘¨</button>
                            <button class="admin-card-action" onclick="changeContentPeriod('month')">æœ¬æœˆ</button>
                        </div>
                    </div>

                    <!-- å†…å®¹ç»Ÿè®¡ -->
                    <div class="admin-stats-grid">
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">æ€»ç”Ÿæˆå†…å®¹</div>
                                <div class="admin-stat-icon" style="background: #e0e7ff; color: #1e40af;">ğŸ“„</div>
                            </div>
                            <div class="admin-stat-value" id="totalContentGenerated">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 18.5%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">å‘å¸ƒå†…å®¹æ•°</div>
                                <div class="admin-stat-icon" style="background: #fef3c7; color: #a16207;">ğŸ“¤</div>
                            </div>
                            <div class="admin-stat-value" id="publishedContent">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 12.3%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">å†…å®¹è´¨é‡è¯„åˆ†</div>
                                <div class="admin-stat-icon" style="background: #fbbf24; color: #f59e0b;">â­</div>
                            </div>
                            <div class="admin-stat-value" id="contentQualityScore">0.0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 6.8%
                            </div>
                        </div>
                    </div>

                    <!-- å†…å®¹è¶‹åŠ¿å›¾è¡¨ -->
                    <div class="admin-content-grid">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h3 class="admin-card-title">å†…å®¹ç”Ÿæˆè¶‹åŠ¿</h3>
                            </div>
                            <div class="admin-loading" id="contentLoading">
                                <div class="admin-spinner"></div>
                            </div>
                            <div id="contentContent" style="display: none;">
                                <canvas id="contentChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ç”¨æˆ·è¡Œä¸ºåˆ†æ -->
            <div id="user-behavior" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">ğŸ‘¤ ç”¨æˆ·è¡Œä¸ºåˆ†æ</h3>
                        <div class="admin-card-actions">
                            <button class="admin-card-action" onclick="changeUserBehaviorPeriod('week')">æœ¬å‘¨</button>
                            <button class="admin-card-action" onclick="changeUserBehaviorPeriod('month')">æœ¬æœˆ</button>
                        </div>
                    </div>

                    <!-- ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡ -->
                    <div class="admin-stats-grid">
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">æ´»è·ƒç”¨æˆ·</div>
                                <div class="admin-stat-icon" style="background: #dcfce7; color: #166534;">âš¡</div>
                            </div>
                            <div class="admin-stat-value" id="activeUsersCount">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 8.5%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">æ–°ç”¨æˆ·æ³¨å†Œ</div>
                                <div class="admin-stat-icon" style="background: #22c55e; color: #16a34a;">ğŸ“</div>
                            </div>
                            <div class="admin-stat-value" id="newUserRegistrations">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 3.2%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">ç”¨æˆ·ç•™å­˜ç‡</div>
                                <div class="admin-stat-icon" style="background: #a78bfa; color: #7c3aed;">ğŸ’</div>
                            </div>
                            <div class="admin-stat-value" id="userRetentionRate">0%</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 2.1%
                            </div>
                        </div>
                    </div>

                    <!-- ç”¨æˆ·è¡Œä¸ºè¡¨æ ¼ -->
                    <div class="admin-content-grid">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h3 class="admin-card-title">ç”¨æˆ·æ´»åŠ¨è®°å½•</h3>
                                <div class="admin-card-actions">
                                    <button class="admin-card-action" onclick="refreshUserActivity()">åˆ·æ–°</button>
                                    <button class="admin-card-action" onclick="exportUserActivity()">å¯¼å‡º</button>
                                </div>
                            </div>
                            <div class="admin-loading" id="userActivityLoading">
                                <div class="admin-spinner"></div>
                            </div>
                            <div id="userActivityContent" style="display: none;">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>ç”¨æˆ·</th>
                                            <th>æ“ä½œ</th>
                                            <th>é¡µé¢</th>
                                            <th>æ—¶é—´</th>
                                            <th>IPåœ°å€</th>
                                        </tr>
                                    </thead>
                                    <tbody id="userActivityTableBody">
                                        <!-- ç”¨æˆ·æ´»åŠ¨æ•°æ®å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å‘å¸ƒæ•ˆæœåˆ†æ -->
            <div id="publishing-performance" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <div class="admin-card-header">
                        <h3 class="admin-card-title">ğŸ“¤ å‘å¸ƒæ•ˆæœåˆ†æ</h3>
                        <div class="admin-card-actions">
                            <button class="admin-card-action" onclick="changePublishingPeriod('week')">æœ¬å‘¨</button>
                            <button class="admin-card-action" onclick="changePublishingPeriod('month')">æœ¬æœˆ</button>
                        </div>
                    </div>

                    <!-- å‘å¸ƒç»Ÿè®¡ -->
                    <div class="admin-stats-grid">
                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">æ€»å‘å¸ƒæ¬¡æ•°</div>
                                <div class="admin-stat-icon" style="background: #ddd6fe; color: #475569;">ğŸ“¤</div>
                            </div>
                            <div class="admin-stat-value" id="totalPublishAttempts">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 25.6%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">æˆåŠŸå‘å¸ƒ</div>
                                <div class="admin-stat-icon" style="background: #10b981; color: #059669;">âœ…</div>
                            </div>
                            <div class="admin-stat-value" id="successfulPublishes">0</div>
                            <div class="admin-stat-change positive">
                                <span>â†‘</span> 18.9%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">å¤±è´¥å‘å¸ƒ</div>
                                <div class="admin-stat-icon" style="background: #ef4444; color: #991b1b;">âŒ</div>
                            </div>
                            <div class="admin-stat-value" id="failedPublishes">0</div>
                            <div class="admin-stat-change negative">
                                <span>â†“</span> 12.3%
                            </div>
                        </div>

                        <div class="admin-stat-card">
                            <div class="admin-stat-header">
                                <div class="admin-stat-title">å¹³å‡å‘å¸ƒæ—¶é—´</div>
                                <div class="admin-stat-icon" style="background: #06b6d4; color: #1e40af;">â±</div>
                            </div>
                            <div class="admin-stat-value" id="avgPublishTime">0s</div>
                            <div class="admin-stat-change positive">
                                <span>â†“</span> 15.7%
                            </div>
                        </div>
                    </div>

                    <!-- å‘å¸ƒè¶‹åŠ¿å›¾è¡¨ -->
                    <div class="admin-content-grid">
                        <div class="admin-card">
                            <div class="admin-card-header">
                                <h3 class="admin-card-title">å‘å¸ƒè¶‹åŠ¿åˆ†æ</h3>
                            </div>
                            <div class="admin-loading" id="publishingLoading">
                                <div class="admin-spinner"></div>
                            </div>
                            <div id="publishingContent" style="display: none;">
                                <canvas id="publishingChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="security" class="admin-section" style="display: none;">
                <div class="admin-empty-state">
                    <div class="admin-empty-state-icon">ğŸ”</div>
                    <h3>å®‰å…¨ä¸­å¿ƒ</h3>
                    <p>å®‰å…¨ä¸­å¿ƒåŠŸèƒ½å·²é›†æˆåˆ°æ•°æ®åˆ†ææ¨¡å—</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ç®¡ç†æ§åˆ¶å°JavaScript
        let currentSection = 'overview';
        let articleChart = null;

        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
            setupNavigation();
            startAutoRefresh();
        });

        // åˆå§‹åŒ–ä»ªè¡¨æ¿
        function initializeDashboard() {
            loadDashboardData();
            initializeChart();
            updateSystemUptime();
        }

        // è®¾ç½®å¯¼èˆª
        function setupNavigation() {
            const navLinks = document.querySelectorAll('.admin-nav-link');
            console.log('è®¾ç½®å¯¼èˆªï¼šæ‰¾åˆ°', navLinks.length, 'ä¸ªå¯¼èˆªé“¾æ¥');
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.dataset.section;
                    console.log('ç‚¹å‡»å¯¼èˆªï¼š', section);
                    switchSection(section);
                });
            });
        }

        // åˆ‡æ¢éƒ¨åˆ†
        function switchSection(section) {
            console.log('åˆ‡æ¢åˆ°éƒ¨åˆ†ï¼š', section);

            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            document.querySelectorAll('.admin-nav-link').forEach(link => {
                link.classList.remove('active');
            });
            const activeLink = document.querySelector(`[data-section="${section}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
                console.log('æ¿€æ´»å¯¼èˆªé“¾æ¥ï¼š', section);
            }

            // éšè—æ‰€æœ‰éƒ¨åˆ†
            document.querySelectorAll('.admin-section').forEach(sec => {
                sec.style.display = 'none';
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„éƒ¨åˆ†
            const targetSection = document.getElementById(section);
            if (targetSection) {
                targetSection.style.display = 'block';
                currentSection = section;
                console.log('æ˜¾ç¤ºéƒ¨åˆ†ï¼š', section);

                // åŠ è½½éƒ¨åˆ†æ•°æ®
                loadSectionData(section);
            } else {
                console.error('æœªæ‰¾åˆ°éƒ¨åˆ†ï¼š', section);
            }
        }

        // åŠ è½½éƒ¨åˆ†æ•°æ®
        function loadSectionData(section) {
            switch(section) {
                case 'overview':
                    loadDashboardData();
                    break;
                case 'users':
                    loadUsersData();
                    break;
                case 'workflows':
                    loadWorkflowsData();
                    break;
                case 'templates':
                    loadTemplatesData();
                    break;
                case 'analytics':
                    loadAnalyticsData();
                    break;
                case 'content-analysis':
                    loadContentAnalysisData();
                    break;
                case 'user-behavior':
                    loadUserBehaviorData();
                    break;
                case 'publishing-performance':
                    loadPublishingPerformanceData();
                    break;
                case 'publishing':
                    loadPublishingData();
                    break;
                case 'logs':
                    initLogSection();
                    break;
            }
        }

        // åŠ è½½æ¨¡æ¿æ•°æ®
        async function loadTemplatesData() {
            const loading = document.getElementById('templatesLoading');
            const content = document.getElementById('templatesContent');

            if (loading) loading.style.display = 'flex';

            try {
                // è°ƒç”¨çœŸå®APIè·å–æ¨¡æ¿ç»Ÿè®¡æ•°æ®
                const statsResponse = await fetch('/api/prompt-templates/stats');
                const statsData = await statsResponse.json();

                // è·å–æœ€è¿‘ä½¿ç”¨çš„æ¨¡æ¿åˆ—è¡¨
                const templatesResponse = await fetch('/api/prompt-templates/templates?limit=10');
                const templatesData = await templatesResponse.json();

                // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
                if (statsData.success && statsData.data) {
                    updateStatCard('totalTemplates', statsData.data.total_templates || 0);
                    updateStatCard('activeTemplates', statsData.data.active_templates || 0);
                    updateStatCard('todayTemplateUsage', statsData.data.today_usage || 0);
                }

                // æ›´æ–°æ´»åŠ¨è¡¨æ ¼
                if (loading) loading.style.display = 'none';
                if (content) {
                    content.style.display = 'block';
                    const tbody = document.getElementById('templateActivityTableBody');

                    if (templatesData.success && templatesData.data && templatesData.data.length > 0) {
                        tbody.innerHTML = templatesData.data.slice(0, 5).map(template => `
                            <tr>
                                <td>${template.name || '-'}</td>
                                <td><span class="admin-status-badge admin-status-online">${template.category_name || 'æœªåˆ†ç±»'}</span></td>
                                <td>${template.usage_count || 0} æ¬¡</td>
                                <td>${template.updated_at ? new Date(template.updated_at).toLocaleString('zh-CN') : '-'}</td>
                                <td><span class="admin-status-badge ${template.is_active ? 'admin-status-success' : 'admin-status-offline'}">${template.is_active ? 'å¯ç”¨' : 'ç¦ç”¨'}</span></td>
                            </tr>
                        `).join('');
                    } else {
                        tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:#999;">æš‚æ— æ¨¡æ¿æ•°æ®</td></tr>';
                    }
                }
            } catch (error) {
                console.error('Failed to load templates data:', error);
                if (loading) loading.style.display = 'none';
                if (content) {
                    content.style.display = 'block';
                    const tbody = document.getElementById('templateActivityTableBody');
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:#f56c6c;">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</td></tr>';
                }
            }
        }

        function refreshTemplatesData() {
            loadTemplatesData();
            showNotification('æ¨¡æ¿æ•°æ®å·²åˆ·æ–°', 'success');
        }

        function refreshTemplateActivity() {
            loadTemplatesData();
            showNotification('æ¨¡æ¿æ´»åŠ¨å·²åˆ·æ–°', 'success');
        }

        function exportAnalytics() {
            showNotification('æ•°æ®åˆ†æå¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        // ============================================================================
        // é€šç”¨åˆ†é¡µå˜é‡
        // ============================================================================
        let usersCurrentPage = 1;
        let usersPageSize = 10;
        let usersTotalPages = 1;
        let usersTotal = 0;

        let workflowsCurrentPage = 1;
        let workflowsPageSize = 10;
        let workflowsTotalPages = 1;
        let workflowsTotal = 0;

        // ============================================================================
        // å‘å¸ƒç®¡ç†åŠŸèƒ½
        // ============================================================================
        let publishingCurrentPage = 1;
        let publishingPageSize = 20;
        let publishingTotalPages = 1;
        let publishingHistoryData = [];
        let currentPublishContent = null;

        // åŠ è½½å‘å¸ƒæ•°æ®
        async function loadPublishingData() {
            const loading = document.getElementById('publishingLoading');
            const content = document.getElementById('publishingContent');

            if (loading) loading.style.display = 'flex';

            try {
                // è·å–ç­›é€‰æ¡ä»¶
                const platform = document.getElementById('publishPlatformFilter')?.value || '';
                const status = document.getElementById('publishStatusFilter')?.value || '';
                const dateFrom = document.getElementById('publishDateFrom')?.value || '';
                const dateTo = document.getElementById('publishDateTo')?.value || '';

                // æ„å»ºæŸ¥è¯¢å‚æ•°
                const params = new URLSearchParams({
                    page: publishingCurrentPage,
                    limit: publishingPageSize
                });
                if (platform) params.append('platform', platform);
                if (status) params.append('status', status);
                if (dateFrom) params.append('date_from', dateFrom);
                if (dateTo) params.append('date_to', dateTo);

                // å¹¶è¡ŒåŠ è½½å†å²è®°å½•å’Œç»Ÿè®¡æ•°æ®
                const [historyRes, statsRes] = await Promise.all([
                    fetch(`/api/admin/publishing/history?${params}`),
                    fetch('/api/admin/publishing/stats?period=all')
                ]);

                const historyData = await historyRes.json();
                const statsData = await statsRes.json();

                if (loading) loading.style.display = 'none';

                // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
                if (statsData.success && statsData.data) {
                    document.getElementById('publishTotalAttempts').textContent = statsData.data.total_attempts || 0;
                    document.getElementById('publishSuccessCount').textContent = statsData.data.successful || 0;
                    document.getElementById('publishFailedCount').textContent = statsData.data.failed || 0;
                    document.getElementById('publishSuccessRate').textContent = (statsData.data.success_rate || 0) + '%';
                }

                // æ›´æ–°è¡¨æ ¼
                if (historyData.success && historyData.history) {
                    publishingHistoryData = historyData.history;
                    publishingTotalPages = historyData.pages || 1;
                    renderPublishHistoryTable(historyData.history);
                    renderPublishingPagination(historyData.total, historyData.page, historyData.pages);
                } else {
                    renderPublishHistoryTable([]);
                }

            } catch (error) {
                console.error('åŠ è½½å‘å¸ƒæ•°æ®å¤±è´¥:', error);
                if (loading) loading.style.display = 'none';
                showNotification('åŠ è½½å‘å¸ƒæ•°æ®å¤±è´¥', 'error');
            }
        }

        // æ¸²æŸ“å‘å¸ƒå†å²è¡¨æ ¼
        function renderPublishHistoryTable(history) {
            const tbody = document.getElementById('publishHistoryTableBody');
            if (!tbody) return;

            if (!history || history.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="admin-empty-state" style="padding: 40px;">
                            <div class="admin-empty-state-icon">ğŸ“¤</div>
                            <p>æš‚æ— å‘å¸ƒè®°å½•</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = history.map(item => {
                const statusClass = item.status === 'success' ? 'admin-status-success' : 'admin-status-failed';
                const statusText = item.status === 'success' ? 'æˆåŠŸ' : 'å¤±è´¥';
                const publishTime = item.published_at ? new Date(item.published_at).toLocaleString('zh-CN') : 'N/A';
                const title = item.article_title || 'æœªçŸ¥æ ‡é¢˜';
                const displayTitle = title.length > 30 ? title.substring(0, 30) + '...' : title;

                return `
                    <tr>
                        <td>${item.id}</td>
                        <td title="${escapeHtml(title)}">${escapeHtml(displayTitle)}</td>
                        <td>${escapeHtml(item.username || 'N/A')}</td>
                        <td>${escapeHtml(item.platform || 'N/A')}</td>
                        <td><span class="admin-status-badge ${statusClass}">${statusText}</span></td>
                        <td>${publishTime}</td>
                        <td class="admin-action-group">
                            ${item.article_content ? `<button onclick="viewPublishContent(${item.id})" class="admin-action-btn">æŸ¥çœ‹</button>` : ''}
                            ${item.url ? `<a href="${escapeHtml(item.url)}" target="_blank" class="admin-action-btn primary">é“¾æ¥</a>` : ''}
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // ============================================================================
        // é€šç”¨åˆ†é¡µæ¸²æŸ“å‡½æ•°
        // ============================================================================
        function renderPagination(prefix, total, currentPage, totalPages, pageSize, goToPageFunc) {
            const pageInfo = document.getElementById(`${prefix}PageInfo`);
            const pageButtons = document.getElementById(`${prefix}PageButtons`);
            const pagination = document.getElementById(`${prefix}Pagination`);

            // å¦‚æœæ€»æ•°å°äºç­‰äº10ï¼Œéšè—åˆ†é¡µ
            if (total <= 10) {
                if (pagination) pagination.style.display = 'none';
                return;
            }

            // æ˜¾ç¤ºåˆ†é¡µ
            if (pagination) pagination.style.display = 'flex';

            if (pageInfo) {
                const start = (currentPage - 1) * pageSize + 1;
                const end = Math.min(currentPage * pageSize, total);
                pageInfo.textContent = `æ˜¾ç¤º ${start}-${end} æ¡ï¼Œå…± ${total} æ¡`;
            }

            if (pageButtons) {
                let buttonsHtml = '';

                // ä¸Šä¸€é¡µ
                buttonsHtml += `<button class="admin-page-btn" ${currentPage <= 1 ? 'disabled' : ''}
                    onclick="${goToPageFunc}(${currentPage - 1})">ä¸Šä¸€é¡µ</button>`;

                // é¡µç 
                for (let i = 1; i <= totalPages; i++) {
                    if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
                        buttonsHtml += `<button class="admin-page-btn ${i === currentPage ? 'active' : ''}"
                            onclick="${goToPageFunc}(${i})">${i}</button>`;
                    } else if (i === currentPage - 3 || i === currentPage + 3) {
                        buttonsHtml += `<span style="padding: 0 8px;">...</span>`;
                    }
                }

                // ä¸‹ä¸€é¡µ
                buttonsHtml += `<button class="admin-page-btn" ${currentPage >= totalPages ? 'disabled' : ''}
                    onclick="${goToPageFunc}(${currentPage + 1})">ä¸‹ä¸€é¡µ</button>`;

                pageButtons.innerHTML = buttonsHtml;
            }
        }

        // æ¸²æŸ“å‘å¸ƒå†å²åˆ†é¡µ
        function renderPublishingPagination(total, currentPage, totalPages) {
            renderPagination('publishing', total, currentPage, totalPages, publishingPageSize, 'goToPublishingPage');
        }

        // è·³è½¬åˆ°æŒ‡å®šé¡µ
        function goToPublishingPage(page) {
            if (page < 1 || page > publishingTotalPages) return;
            publishingCurrentPage = page;
            loadPublishingData();
        }

        // æœç´¢å‘å¸ƒå†å²
        function searchPublishHistory() {
            publishingCurrentPage = 1;
            loadPublishingData();
        }

        // é‡ç½®ç­›é€‰æ¡ä»¶
        function resetPublishFilters() {
            document.getElementById('publishPlatformFilter').value = '';
            document.getElementById('publishStatusFilter').value = '';
            document.getElementById('publishDateFrom').value = '';
            document.getElementById('publishDateTo').value = '';
            publishingCurrentPage = 1;
            loadPublishingData();
        }

        // åˆ·æ–°å‘å¸ƒæ•°æ®
        function refreshPublishingData() {
            loadPublishingData();
            showNotification('å‘å¸ƒæ•°æ®å·²åˆ·æ–°', 'success');
        }

        // æŸ¥çœ‹å‘å¸ƒå†…å®¹
        function viewPublishContent(id) {
            const item = publishingHistoryData.find(h => h.id === id);
            if (!item || !item.article_content) {
                showNotification('æ²¡æœ‰æ–‡ç« å†…å®¹', 'warning');
                return;
            }

            currentPublishContent = item.article_content;
            document.getElementById('publishContentModalTitle').textContent = item.article_title || 'æ–‡ç« å†…å®¹';
            document.getElementById('publishContentModalBody').textContent = item.article_content;
            document.getElementById('publishContentModal').style.display = 'flex';
        }

        // å…³é—­å†…å®¹æ¨¡æ€æ¡†
        function closePublishContentModal() {
            document.getElementById('publishContentModal').style.display = 'none';
            currentPublishContent = null;
        }

        // å¤åˆ¶å‘å¸ƒå†…å®¹
        function copyPublishContent() {
            if (!currentPublishContent) return;

            navigator.clipboard.writeText(currentPublishContent).then(() => {
                showNotification('å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                showNotification('å¤åˆ¶å¤±è´¥', 'error');
            });
        }

        // HTMLè½¬ä¹‰
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // åˆ‡æ¢åˆ†æå›¾è¡¨å‘¨æœŸ
        let currentAnalysisPeriod = 'week';
        let currentContentType = 'visits';

        function changeAnalysisPeriod(period) {
            currentAnalysisPeriod = period;
            loadAnalyticsData();
        }

        function changeAnalysisChart(type) {
            currentContentType = type;
            loadAnalyticsData();
        }

        // åŠ è½½æ•°æ®åˆ†ææ•°æ®
        async function loadAnalyticsData() {
            const loading = document.getElementById('analysisLoading');
            const content = document.getElementById('analysisContent');

            if (loading) loading.style.display = 'flex';

            // æ¨¡æ‹ŸAPIè°ƒç”¨
            setTimeout(() => {
                const mockAnalyticsData = {
                    todayVisits: 1245,
                    weekVisits: 8642,
                    monthVisits: 35126,
                    todayArticleGeneration: 89,
                    weekArticleGeneration: 578,
                    monthArticleGeneration: 2310,
                    avgResponseTime: 245,
                    userGrowthRate: 8.5,
                    newUsersToday: 12,
                    userRetentionRate: 68.2,
                    hotTopics: [
                        { topic: 'AIè¥é”€ç­–ç•¥', count: 156, growth: 23.5 },
                        { topic: 'ä¼ä¸šæ•°å­—åŒ–è½¬å‹', count: 142, growth: 18.2 },
                        { topic: 'å†…å®¹åˆ›ä½œæŠ€å·§', count: 98, growth: 15.6 }
                    ]
                };

                // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
                updateStatCard('todayVisits', mockAnalyticsData.todayVisits);
                updateStatCard('todayArticleGeneration', mockAnalyticsData.todayArticleGeneration);
                updateStatCard('avgResponseTime', mockAnalyticsData.avgResponseTime);

                // æ›´æ–°ç”¨æˆ·ç»Ÿè®¡
                updateStatCard('activeUsersCount', mockAnalyticsData.monthVisits / 30); // æœˆæ´»è·ƒç”¨æˆ·ä¼°ç®—
                updateStatCard('newUserRegistrations', mockAnalyticsData.newUsersToday);
                updateStatCard('userRetentionRate', mockAnalyticsData.userRetentionRate);

                // æ›´æ–°å›¾è¡¨
                updateAnalyticsChart();

                if (loading) loading.style.display = 'none';
                if (content) {
                    content.style.display = 'block';
                    // æ˜¾ç¤ºçƒ­é—¨å†…å®¹
                    const hotContentEl = document.getElementById('hotContent');
                    if (hotContentEl) {
                        hotContentEl.innerHTML = mockAnalyticsData.hotTopics.map((topic, index) => `
                            <div class="quick-action-card" style="cursor: default;">
                                <div class="quick-action-title">#${index + 1}</div>
                                <div class="quick-action-desc">${topic.topic}</div>
                                <div class="quick-action-desc">${topic.count} æ¬¡ä½¿ç”¨</div>
                                <div class="quick-action-desc">å¢é•¿ç‡: ${topic.growth}%</div>
                            </div>
                        `).join('');
                    }
                }
            }, 800);
        }

        // åŠ è½½å†…å®¹åˆ†ææ•°æ®
        async function loadContentAnalysisData(period = 'week') {
            const loading = document.getElementById('contentLoading');
            const content = document.getElementById('contentContent');

            if (loading) loading.style.display = 'flex';

            try {
                // è°ƒç”¨çœŸå®API
                const response = await fetch(`/api/admin/analytics/content?period=${period}`);
                const result = await response.json();

                if (!result.success) {
                    throw new Error(result.error || 'è·å–å†…å®¹åˆ†ææ•°æ®å¤±è´¥');
                }

                const data = result.data;

                // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
                updateStatCard('totalContentGenerated', data.total_generated);
                updateStatCard('publishedContent', data.total_published);
                updateStatCard('contentQualityScore', data.quality_score);

                // æ›´æ–°å†…å®¹è¶‹åŠ¿å›¾è¡¨ï¼ˆä¼ å…¥è¶‹åŠ¿æ•°æ®ï¼‰
                updateContentChart(data.trend);

                if (loading) loading.style.display = 'none';
                if (content) content.style.display = 'block';

                // æš‚æ—¶éšè—åˆ†ç±»è¡¨æ ¼ï¼ˆæ•°æ®åº“ä¸­æš‚æ— åˆ†ç±»æ•°æ®ï¼‰
                /*
                const categoriesEl = document.getElementById('contentCategoriesTable');
                if (categoriesEl) {
                    categoriesEl.innerHTML = mockContentData.topPerformingCategories.map((cat, index) => `
                        <tr>
                            <td>${cat.category}</td>
                            <td>${cat.count}</td>
                            <td><span class="admin-status-badge admin-status-online">${cat.performance.toFixed(1)}</span></td>
                        </tr>
                    `).join('');
                }
                */

            } catch (error) {
                console.error('åŠ è½½å†…å®¹åˆ†ææ•°æ®å¤±è´¥:', error);
                showNotification('åŠ è½½å†…å®¹åˆ†ææ•°æ®å¤±è´¥', 'error');
                if (loading) loading.style.display = 'none';
            }
        }

        // åŠ è½½ç”¨æˆ·è¡Œä¸ºæ•°æ®
        async function loadUserBehaviorData() {
            const loading = document.getElementById('userActivityLoading');
            const content = document.getElementById('userActivityContent');

            if (loading) loading.style.display = 'flex';

            // æ¨¡æ‹ŸAPIè°ƒç”¨
            setTimeout(() => {
                const mockUserBehaviorData = {
                    activeUsers: 856,
                    newUsersToday: 12,
                    userRetentionRate: 68.2,
                    recentActivities: [
                        { user: 'admin', action: 'ç™»å½•ç³»ç»Ÿ', page: '/admin', time: '2025-12-15 10:30' },
                        { user: 'user1', action: 'ç”Ÿæˆæ–‡ç« ', page: '/platform', time: '2025-12-15 09:15' },
                        { user: 'user2', action: 'å‘å¸ƒå†…å®¹', page: '/publish', time: '2025-12-15 08:45' },
                        { user: 'admin', action: 'æŸ¥çœ‹åˆ†æ', page: '/admin', time: '2025-12-15 08:20' }
                    ]
                };

                // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
                updateStatCard('activeUsersCount', mockUserBehaviorData.activeUsers);
                updateStatCard('newUserRegistrations', mockUserBehaviorData.newUsersToday);
                updateStatCard('userRetentionRate', mockUserBehaviorData.userRetentionRate);

                // æ›´æ–°æ´»åŠ¨è¡¨æ ¼
                if (content) {
                    content.style.display = 'block';
                    const tbody = document.getElementById('userActivityTableBody');
                    tbody.innerHTML = mockUserBehaviorData.recentActivities.map((activity, index) => `
                        <tr>
                            <td>${activity.user}</td>
                            <td><span class="admin-status-badge admin-status-online">${activity.action}</span></td>
                            <td>${activity.page}</td>
                            <td>${activity.time}</td>
                            <td><span class="admin-status-badge admin-status-success">${activity.ip || '127.0.0.1'}</span></td>
                        </tr>
                    `).join('');
                }
            }, 800);
        }

        // åŠ è½½å‘å¸ƒæ•ˆæœæ•°æ®
        async function loadPublishingPerformanceData() {
            const loading = document.getElementById('publishingLoading');
            const content = document.getElementById('publishingContent');

            if (loading) loading.style.display = 'flex';

            // æ¨¡æ‹ŸAPIè°ƒç”¨
            setTimeout(() => {
                const mockPublishingData = {
                    totalPublishAttempts: 456,
                    successfulPublishes: 89,
                    failedPublishes: 67,
                    publishSuccessRate: 57.0,
                    avgPublishTime: 3250,
                    platformPerformance: [
                        { platform: 'çŸ¥ä¹', successRate: 62.5, avgTime: 2800 },
                        { platform: 'CSDN', successRate: 48.3, avgTime: 4200 },
                        { platform: 'æ˜é‡‘', successRate: 55.8, avgTime: 3600 }
                    ]
                };

                // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
                updateStatCard('totalPublishAttempts', mockPublishingData.totalPublishAttempts);
                updateStatCard('successfulPublishes', mockPublishingData.successfulPublishes);
                updateStatCard('publishSuccessRate', mockPublishingData.publishSuccessRate);
                updateStatCard('avgPublishTime', mockPublishingData.avgPublishTime);

                // æ›´æ–°å‘å¸ƒæ•ˆæœå›¾è¡¨
                updatePublishingChart();

                if (loading) loading.style.display = 'none';
                if (content) {
                    content.style.display = 'block';
                    // æ˜¾ç¤ºå¹³å°æ€§èƒ½å¯¹æ¯”
                    const performanceEl = document.getElementById('platformPerformanceTable');
                    if (performanceEl) {
                        performanceEl.innerHTML = mockPublishingData.platformPerformance.map((platform, index) => `
                            <tr>
                                <td>${platform.platform}</td>
                                <td><span class="admin-status-badge admin-status-online">${platform.successRate.toFixed(1)}%</span></td>
                                <td>${platform.avgTime}ms</td>
                                <td><span class="admin-status-badge ${platform.successRate > 60 ? 'admin-status-warning' : 'admin-status-online'}">${platform.successRate > 60 ? 'è¾ƒæ…¢' : 'æ­£å¸¸'}</span></td>
                            </tr>
                        `).join('');
                    }
                }
            }, 800);
        }

        // åˆ‡æ¢å†…å®¹å‘¨æœŸ
        function changeContentPeriod(period) {
            // è¿™é‡Œå¯ä»¥å®ç°å†…å®¹åˆ†æçš„å‘¨æœŸåˆ‡æ¢é€»è¾‘
            console.log(`åˆ‡æ¢å†…å®¹åˆ†æå‘¨æœŸä¸º: ${period}`);
            showNotification(`å†…å®¹åˆ†æå‘¨æœŸå·²åˆ‡æ¢ä¸º${period}`, 'success');
        }

        // åˆ‡æ¢ç”¨æˆ·è¡Œä¸ºå‘¨æœŸ
        function changeUserBehaviorPeriod(period) {
            console.log(`åˆ‡æ¢ç”¨æˆ·è¡Œä¸ºåˆ†æå‘¨æœŸä¸º: ${period}`);
            showNotification(`ç”¨æˆ·è¡Œä¸ºåˆ†æå‘¨æœŸå·²åˆ‡æ¢ä¸º${period}`, 'success');
        }

        // åˆ‡æ¢å‘å¸ƒå‘¨æœŸ
        function changePublishingPeriod(period) {
            console.log(`åˆ‡æ¢å‘å¸ƒæ•ˆæœåˆ†æå‘¨æœŸä¸º: ${period}`);
            showNotification(`å‘å¸ƒæ•ˆæœåˆ†æå‘¨æœŸå·²åˆ‡æ¢ä¸º${period}`, 'success');
        }

        // åˆ·æ–°çƒ­é—¨å†…å®¹
        function refreshHotContent() {
            loadContentAnalysisData();
            showNotification('çƒ­é—¨å†…å®¹å·²åˆ·æ–°', 'success');
        }

        // åˆ·æ–°ç”¨æˆ·æ´»åŠ¨
        function refreshUserActivity() {
            loadUserBehaviorData();
            showNotification('ç”¨æˆ·æ´»åŠ¨å·²åˆ·æ–°', 'success');
        }

        // å¯¼å‡ºç”¨æˆ·æ´»åŠ¨
        function exportUserActivity() {
            showNotification('ç”¨æˆ·æ´»åŠ¨å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        // æ›´æ–°åˆ†æå›¾è¡¨
        function updateAnalyticsChart() {
            if (!analysisChart) return;

            const data = {
                week: {
                    labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
                    datasets: currentContentType === 'visits' ? {
                        label: 'è®¿é—®é‡',
                        data: [3200, 3800, 4200, 5100, 4800, 4500, 5200],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        tension: 0.4,
                        fill: true
                    } : {
                        label: 'ä½¿ç”¨é‡',
                        data: [65, 78, 90, 81, 156, 125, 98],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        tension: 0.4,
                        fill: true
                    }
                },
                month: {
                    labels: ['ç¬¬1å‘¨', 'ç¬¬2å‘¨', 'ç¬¬3å‘¨', 'ç¬¬4å‘¨'],
                    datasets: currentContentType === 'visits' ? {
                        label: 'è®¿é—®é‡',
                        data: [12000, 15000, 13500, 16800, 14200, 18900],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        tension: 0.4,
                        fill: true
                    } : {
                        label: 'ä½¿ç”¨é‡',
                        data: [320, 450, 380, 420, 510, 480],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        tension: 0.4,
                        fill: true
                    }
                }
            };

            const selectedData = data[currentAnalysisPeriod] || data.week;
            analysisChart.data.labels = selectedData.labels;
            analysisChart.data.datasets[0].data = selectedData.datasets[0].data;
            analysisChart.data.datasets[0].label = selectedData.datasets[0].label;
            analysisChart.data.datasets[0].borderColor = selectedData.datasets[0].borderColor;
            analysisChart.data.datasets[0].backgroundColor = selectedData.datasets[0].backgroundColor;
            analysisChart.update();
        }

        // æ›´æ–°å†…å®¹å›¾è¡¨
        function updateContentChart(trendData = null) {
            if (!contentChart) return;

            // å¦‚æœæ²¡æœ‰ä¼ å…¥æ•°æ®ï¼Œä½¿ç”¨ç©ºæ•°æ®
            if (!trendData || !trendData.labels) {
                trendData = {
                    labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
                    generated: [0, 0, 0, 0, 0, 0, 0],
                    published: [0, 0, 0, 0, 0, 0, 0]
                };
            }

            // æ›´æ–°å›¾è¡¨æ•°æ®
            contentChart.data.labels = trendData.labels;
            contentChart.data.datasets[0].data = trendData.generated;
            contentChart.data.datasets[1].data = trendData.published;

            // ä¿æŒåŸæœ‰çš„æ ·å¼
            contentChart.data.datasets[0].label = 'å†…å®¹ç”Ÿæˆ';
            contentChart.data.datasets[0].borderColor = '#22c55e';
            contentChart.data.datasets[0].backgroundColor = 'rgba(34, 197, 94, 0.2)';
            contentChart.data.datasets[0].tension = 0.4;
            contentChart.data.datasets[0].fill = true;

            contentChart.data.datasets[1].label = 'å†…å®¹å‘å¸ƒ';
            contentChart.data.datasets[1].borderColor = '#16a34a';
            contentChart.data.datasets[1].backgroundColor = 'rgba(22, 163, 74, 0.2)';
            contentChart.data.datasets[1].tension = 0.4;
            contentChart.data.datasets[1].fill = true;

            contentChart.update();
        }

        // æ›´æ–°å‘å¸ƒæ•ˆæœå›¾è¡¨
        function updatePublishingChart() {
            if (!publishingChart) return;

            const data = {
                week: {
                    labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
                    datasets: [{
                        label: 'æˆåŠŸå‘å¸ƒ',
                        data: [45, 52, 48, 65, 78, 42, 58],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'å¤±è´¥å‘å¸ƒ',
                        data: [8, 12, 15, 22, 28, 15],
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.2)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                month: {
                    labels: ['ç¬¬1å‘¨', 'ç¬¬2å‘¨', 'ç¬¬3å‘¨', 'ç¬¬4å‘¨'],
                    datasets: [{
                        label: 'æˆåŠŸå‘å¸ƒ',
                        data: [180, 220, 195, 285, 342, 415],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'å¤±è´¥å‘å¸ƒ',
                        data: [32, 88, 105, 142, 188, 220],
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.2)',
                        tension: 0.4,
                        fill: true
                    }]
                }
            };

            const selectedData = data[currentAnalysisPeriod] || data.week;
            publishingChart.data.labels = selectedData.labels;
            publishingChart.data.datasets[0].data = selectedData.datasets[0].data;
            publishingChart.data.datasets[1].data = selectedData.datasets[1].data;
            publishingChart.data.datasets[0].borderColor = selectedData.datasets[0].borderColor;
            publishingChart.data.datasets[0].backgroundColor = selectedData.datasets[0].backgroundColor;
            publishingChart.data.datasets[1].borderColor = selectedData.datasets[1].borderColor;
            publishingChart.data.datasets[1].backgroundColor = selectedData.datasets[1].backgroundColor;
            publishingChart.update();
        }

        // åˆå§‹åŒ–å›¾è¡¨
        function initializeCharts() {
            // åˆ†æå›¾è¡¨
            const analysisCtx = document.getElementById('analysisChart');
            if (analysisCtx) {
                analysisChart = new Chart(analysisCtx, {
                    type: 'line',
                    data: {
                        labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
                        datasets: [{
                            label: 'è®¿é—®é‡',
                            data: [0, 0, 0, 0, 0, 0, 0],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.2)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    borderDash: [5, 5]
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            // å†…å®¹å›¾è¡¨
            const contentCtx = document.getElementById('contentChart');
            if (contentCtx) {
                contentChart = new Chart(contentCtx, {
                    type: 'line',
                    data: {
                        labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
                        datasets: [{
                                label: 'å†…å®¹ç”Ÿæˆ',
                                data: [0, 0, 0, 0, 0, 0, 0],
                                borderColor: '#22c55e',
                                backgroundColor: 'rgba(34, 197, 94, 0.2)',
                                tension: 0.4,
                                fill: true
                            }, {
                                label: 'å†…å®¹å‘å¸ƒ',
                                data: [0, 0, 0, 0, 0, 0],
                                borderColor: '#16a34a',
                                backgroundColor: 'rgba(22, 163, 74, 0.2)',
                                tension: 0.4,
                                fill: true
                            }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    borderDash: [5, 5]
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }

            // å‘å¸ƒæ•ˆæœå›¾è¡¨
            const publishingCtx = document.getElementById('publishingChart');
            if (publishingCtx) {
                publishingChart = new Chart(publishingCtx, {
                    type: 'line',
                    data: {
                        labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
                        datasets: [{
                                label: 'æˆåŠŸå‘å¸ƒ',
                                data: [0, 0, 0, 0, 0, 0, 0],
                                borderColor: '#10b981',
                                backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                tension: 0.4,
                                fill: true
                            }, {
                                label: 'å¤±è´¥å‘å¸ƒ',
                                data: [0, 0, 0, 0, 0, 0],
                                borderColor: '#ef4444',
                                backgroundColor: 'rgba(239, 68, 68, 0.2)',
                                tension: 0.4,
                                fill: true
                            }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    borderDash: [5, 5]
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }
        }

        // åŠ è½½ä»ªè¡¨æ¿æ•°æ®
        async function loadDashboardData() {
            try {
                // è°ƒç”¨çœŸå®APIè·å–æ¦‚è§ˆç»Ÿè®¡
                const response = await fetch('/api/admin/stats/overview');
                if (!response.ok) {
                    throw new Error('è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥');
                }

                const result = await response.json();
                if (!result.success) {
                    throw new Error(result.error || 'è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥');
                }

                const data = result.data;

                // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
                updateStatCard('totalUsers', data.total_users);
                updateStatCard('activeUsers', data.active_users);
                updateStatCard('todayArticles', data.today_articles);
                updateStatCard('todayPublishes', data.today_publishes);

                // æ›´æ–°ç”¨æˆ·æ•°é‡å¾½ç« 
                document.getElementById('userCount').textContent = data.total_users;

                // åŠ è½½å›¾è¡¨æ•°æ®
                await updateChartData();

                // åŠ è½½ç³»ç»ŸçŠ¶æ€
                await refreshSystemStatus();

            } catch (error) {
                console.error('åŠ è½½ä»ªè¡¨æ¿æ•°æ®å¤±è´¥:', error);
                showNotification('åŠ è½½æ•°æ®å¤±è´¥: ' + error.message, 'error');
            }
        }

        // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
        function updateStatCard(id, value) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = value.toLocaleString();
            }
        }

        // åˆå§‹åŒ–å›¾è¡¨
        function initializeChart() {
            const ctx = document.getElementById('articleChart').getContext('2d');
            articleChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
                    datasets: [{
                        label: 'æ–‡ç« ç”Ÿæˆæ•°',
                        data: [65, 78, 90, 81, 156, 125, 98],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 3,
                        pointRadius: 5,
                        pointHoverRadius: 7,
                        pointBackgroundColor: '#3b82f6',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointHoverBackgroundColor: '#2563eb',
                        pointHoverBorderColor: '#fff',
                        pointHoverBorderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            padding: 12,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            borderColor: '#3b82f6',
                            borderWidth: 1,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return 'ç”Ÿæˆæ–‡ç« æ•°: ' + context.parsed.y + ' ç¯‡';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                borderDash: [5, 5],
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                font: {
                                    size: 12
                                },
                                color: '#64748b',
                                padding: 8,
                                stepSize: 20,
                                callback: function(value) {
                                    return value + ' ç¯‡';
                                }
                            },
                            title: {
                                display: true,
                                text: 'ç”Ÿæˆæ•°é‡',
                                font: {
                                    size: 12,
                                    weight: 'bold'
                                },
                                color: '#475569',
                                padding: 10
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                },
                                color: '#64748b',
                                padding: 8
                            }
                        }
                    },
                    layout: {
                        padding: {
                            top: 10,
                            right: 10,
                            bottom: 5,
                            left: 5
                        }
                    }
                }
            });
        }

        // æ›´æ–°å›¾è¡¨æ•°æ®
        async function updateChartData(period = 'week') {
            if (!articleChart) return;

            const chartLoading = document.getElementById('chartLoading');
            const canvas = document.getElementById('articleChart');

            try {
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                if (chartLoading) chartLoading.style.display = 'flex';
                if (canvas) canvas.style.opacity = '0.3';

                // è°ƒç”¨çœŸå®APIè·å–å›¾è¡¨æ•°æ®
                const response = await fetch(`/api/admin/stats/charts?period=${period}`);
                if (!response.ok) {
                    throw new Error('è·å–å›¾è¡¨æ•°æ®å¤±è´¥');
                }

                const result = await response.json();
                if (!result.success) {
                    throw new Error(result.error || 'è·å–å›¾è¡¨æ•°æ®å¤±è´¥');
                }

                const chartData = result.data;

                // å¹³æ»‘åŠ¨ç”»æ›´æ–°æ•°æ®
                articleChart.data.labels = chartData.labels;
                articleChart.data.datasets[0].data = chartData.article_generation;
                articleChart.update('active');

            } catch (error) {
                console.error('æ›´æ–°å›¾è¡¨æ•°æ®å¤±è´¥:', error);
                // å‡ºé”™æ—¶ä½¿ç”¨é»˜è®¤æ•°æ®
                const fallbackData = {
                    week: {
                        labels: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
                        data: [0, 0, 0, 0, 0, 0, 0]
                    },
                    month: {
                        labels: ['ç¬¬1å‘¨', 'ç¬¬2å‘¨', 'ç¬¬3å‘¨', 'ç¬¬4å‘¨'],
                        data: [0, 0, 0, 0]
                    },
                    year: {
                        labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'],
                        data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                    }
                };
                const selectedData = fallbackData[period] || fallbackData.week;
                articleChart.data.labels = selectedData.labels;
                articleChart.data.datasets[0].data = selectedData.data;
                articleChart.update('active');
            } finally {
                // éšè—åŠ è½½çŠ¶æ€
                setTimeout(() => {
                    if (chartLoading) chartLoading.style.display = 'none';
                    if (canvas) canvas.style.opacity = '1';
                }, 300);
            }
        }

        // æ›´æ–°ç³»ç»ŸçŠ¶æ€
        function updateSystemStatus(status) {
            const loading = document.getElementById('systemStatusLoading');
            const content = document.getElementById('systemStatusContent');

            if (loading) loading.style.display = 'none';
            if (content) {
                content.style.display = 'block';
                content.innerHTML = `
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span>CPUä½¿ç”¨ç‡</span>
                            <span style="font-weight: 600;">${status.cpu}%</span>
                        </div>
                        <div class="admin-progress-bar">
                            <div class="admin-progress-fill" style="width: ${status.cpu}%"></div>
                        </div>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span>å†…å­˜ä½¿ç”¨ç‡</span>
                            <span style="font-weight: 600;">${status.memory}%</span>
                        </div>
                        <div class="admin-progress-bar">
                            <div class="admin-progress-fill" style="width: ${status.memory}%"></div>
                        </div>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span>ç£ç›˜ä½¿ç”¨ç‡</span>
                            <span style="font-weight: 600;">${status.disk}%</span>
                        </div>
                        <div class="admin-progress-bar">
                            <div class="admin-progress-fill" style="width: ${status.disk}%"></div>
                        </div>
                    </div>
                    <div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span>ç½‘ç»œçŠ¶æ€</span>
                            <span class="admin-status-badge ${status.network === 'good' ? 'admin-status-online' : 'admin-status-warning'}">
                                ${status.network === 'good' ? 'æ­£å¸¸' : 'å¼‚å¸¸'}
                            </span>
                        </div>
                    </div>
                `;
            }
        }

        // åŠ è½½ç”¨æˆ·æ•°æ®
        async function loadUsersData(page = 1, limit = usersPageSize) {
            const loading = document.getElementById('usersLoading');
            const content = document.getElementById('usersContent');

            try {
                if (loading) loading.style.display = 'flex';
                if (content) content.style.display = 'none';

                // è°ƒç”¨çœŸå®APIè·å–ç”¨æˆ·åˆ—è¡¨
                const response = await fetch(`/api/admin/users?page=${page}&limit=${limit}`);
                if (!response.ok) {
                    throw new Error('è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥');
                }

                const result = await response.json();
                if (!result.success) {
                    throw new Error(result.error || 'è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥');
                }

                const users = result.users;
                usersTotal = result.total || users.length;
                usersTotalPages = result.pages || Math.ceil(usersTotal / usersPageSize);
                usersCurrentPage = page;

                if (loading) loading.style.display = 'none';
                if (content) {
                    content.style.display = 'block';
                    const tbody = document.getElementById('usersTableBody');
                    if (users.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">æš‚æ— ç”¨æˆ·æ•°æ®</td></tr>';
                    } else {
                        tbody.innerHTML = users.map(user => `
                            <tr>
                                <td>${user.username}</td>
                                <td>${user.email}</td>
                                <td><span class="admin-status-badge ${user.role === 'admin' ? 'admin-status-warning' : 'admin-status-online'}">${user.role}</span></td>
                                <td>${user.created_at ? user.created_at.split('T')[0] : 'N/A'}</td>
                                <td>${user.last_login ? user.last_login.split('T').join(' ').substring(0, 16) : 'ä»æœªç™»å½•'}</td>
                                <td><span class="admin-status-badge ${user.is_active ? 'admin-status-online' : 'admin-status-offline'}">${user.is_active ? 'æ¿€æ´»' : 'ç¦ç”¨'}</span></td>
                                <td>
                                    <button class="admin-card-action" onclick="editUser(${user.id})">ç¼–è¾‘</button>
                                    <button class="admin-card-action" onclick="deleteUser(${user.id}, '${user.username}')">åˆ é™¤</button>
                                </td>
                            </tr>
                        `).join('');
                    }

                    // æ¸²æŸ“åˆ†é¡µ
                    renderUsersPagination(usersTotal, usersCurrentPage, usersTotalPages);
                }

            } catch (error) {
                console.error('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥:', error);
                if (loading) loading.style.display = 'none';
                if (content) {
                    content.style.display = 'block';
                    const tbody = document.getElementById('usersTableBody');
                    tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px; color: #ef4444;">åŠ è½½å¤±è´¥: ' + error.message + '</td></tr>';
                }
                showNotification('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥: ' + error.message, 'error');
            }
        }

        // æ¸²æŸ“ç”¨æˆ·åˆ†é¡µ
        function renderUsersPagination(total, currentPage, totalPages) {
            renderPagination('users', total, currentPage, totalPages, usersPageSize, 'goToUsersPage');
        }

        // è·³è½¬åˆ°ç”¨æˆ·æŒ‡å®šé¡µ
        function goToUsersPage(page) {
            if (page < 1 || page > usersTotalPages) return;
            loadUsersData(page);
        }

        // ç¼–è¾‘ç”¨æˆ·
        async function editUser(userId) {
            showNotification('ç¼–è¾‘ç”¨æˆ·åŠŸèƒ½å¼€å‘ä¸­...', 'info');
            // TODO: å®ç°ç¼–è¾‘ç”¨æˆ·å¯¹è¯æ¡†å’ŒAPIè°ƒç”¨
        }

        // åˆ é™¤ç”¨æˆ·
        async function deleteUser(userId, username) {
            if (!confirm(`ç¡®å®šè¦åˆ é™¤ç”¨æˆ· "${username}" å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`)) {
                return;
            }

            try {
                const response = await fetch(`/api/admin/users/${userId}`, {
                    method: 'DELETE'
                });

                if (!response.ok) {
                    throw new Error('åˆ é™¤ç”¨æˆ·å¤±è´¥');
                }

                const result = await response.json();
                if (!result.success) {
                    throw new Error(result.error || 'åˆ é™¤ç”¨æˆ·å¤±è´¥');
                }

                showNotification(result.message || 'ç”¨æˆ·åˆ é™¤æˆåŠŸ', 'success');
                // é‡æ–°åŠ è½½ç”¨æˆ·åˆ—è¡¨
                loadUsersData();

            } catch (error) {
                console.error('åˆ é™¤ç”¨æˆ·å¤±è´¥:', error);
                showNotification('åˆ é™¤ç”¨æˆ·å¤±è´¥: ' + error.message, 'error');
            }
        }

        // æ·»åŠ ç”¨æˆ·
        async function addUser() {
            showNotification('æ·»åŠ ç”¨æˆ·åŠŸèƒ½å¼€å‘ä¸­...', 'info');
            // TODO: å®ç°æ·»åŠ ç”¨æˆ·å¯¹è¯æ¡†å’ŒAPIè°ƒç”¨
        }

        // ========================================================================
        // å·¥ä½œæµç®¡ç†
        // ========================================================================

        // åŠ è½½å·¥ä½œæµæ•°æ®
        async function loadWorkflowsData(page = 1, limit = workflowsPageSize) {
            const loading = document.getElementById('workflowsLoading');
            const content = document.getElementById('workflowsContent');

            try {
                if (loading) loading.style.display = 'flex';
                if (content) content.style.display = 'none';

                // è°ƒç”¨çœŸå®APIè·å–å·¥ä½œæµåˆ—è¡¨
                const response = await fetch(`/api/admin/workflows?page=${page}&limit=${limit}`);
                if (!response.ok) {
                    throw new Error('è·å–å·¥ä½œæµåˆ—è¡¨å¤±è´¥');
                }

                const result = await response.json();
                if (!result.success) {
                    throw new Error(result.error || 'è·å–å·¥ä½œæµåˆ—è¡¨å¤±è´¥');
                }

                const workflows = result.workflows;
                workflowsTotal = result.total || workflows.length;
                workflowsTotalPages = result.pages || Math.ceil(workflowsTotal / workflowsPageSize);
                workflowsCurrentPage = page;

                if (loading) loading.style.display = 'none';
                if (content) {
                    content.style.display = 'block';
                    const tbody = document.getElementById('workflowsTableBody');
                    if (workflows.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">æš‚æ— å·¥ä½œæµæ•°æ®</td></tr>';
                    } else {
                        tbody.innerHTML = workflows.map(workflow => {
                            const statusMap = {
                                'in_progress': { text: 'è¿›è¡Œä¸­', class: 'admin-status-warning' },
                                'completed': { text: 'å·²å®Œæˆ', class: 'admin-status-online' },
                                'failed': { text: 'å¤±è´¥', class: 'admin-status-error' }
                            };
                            const status = statusMap[workflow.status] || { text: workflow.status, class: '' };

                            return `
                                <tr>
                                    <td>${workflow.id}</td>
                                    <td>${workflow.company_name}</td>
                                    <td>${workflow.username || 'N/A'}</td>
                                    <td>${workflow.article_count || 0}</td>
                                    <td><span class="admin-status-badge ${status.class}">${status.text}</span></td>
                                    <td>${workflow.created_at ? workflow.created_at.split('T')[0] : 'N/A'}</td>
                                    <td>
                                        <button class="admin-card-action" onclick="viewWorkflow(${workflow.id})">æŸ¥çœ‹</button>
                                        <button class="admin-card-action" onclick="deleteWorkflow(${workflow.id}, '${workflow.company_name}')">åˆ é™¤</button>
                                    </td>
                                </tr>
                            `;
                        }).join('');
                    }

                    // æ¸²æŸ“åˆ†é¡µ
                    renderWorkflowsPagination(workflowsTotal, workflowsCurrentPage, workflowsTotalPages);
                }

            } catch (error) {
                console.error('åŠ è½½å·¥ä½œæµæ•°æ®å¤±è´¥:', error);
                if (loading) loading.style.display = 'none';
                if (content) {
                    content.style.display = 'block';
                    const tbody = document.getElementById('workflowsTableBody');
                    tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px; color: #ef4444;">åŠ è½½å¤±è´¥: ' + error.message + '</td></tr>';
                }
                showNotification('åŠ è½½å·¥ä½œæµæ•°æ®å¤±è´¥: ' + error.message, 'error');
            }
        }

        // æ¸²æŸ“å·¥ä½œæµåˆ†é¡µ
        function renderWorkflowsPagination(total, currentPage, totalPages) {
            renderPagination('workflows', total, currentPage, totalPages, workflowsPageSize, 'goToWorkflowsPage');
        }

        // è·³è½¬åˆ°å·¥ä½œæµæŒ‡å®šé¡µ
        function goToWorkflowsPage(page) {
            if (page < 1 || page > workflowsTotalPages) return;
            loadWorkflowsData(page);
        }

        // æŸ¥çœ‹å·¥ä½œæµè¯¦æƒ…
        async function viewWorkflow(workflowId) {
            showNotification('æŸ¥çœ‹å·¥ä½œæµè¯¦æƒ…åŠŸèƒ½å¼€å‘ä¸­...', 'info');
            // TODO: å®ç°å·¥ä½œæµè¯¦æƒ…å¯¹è¯æ¡†
        }

        // åˆ é™¤å·¥ä½œæµ
        async function deleteWorkflow(workflowId, companyName) {
            if (!confirm(`ç¡®å®šè¦åˆ é™¤å·¥ä½œæµ "${companyName}" å—ï¼Ÿæ­¤æ“ä½œå°†åˆ é™¤æ‰€æœ‰ç›¸å…³æ–‡ç« ï¼`)) {
                return;
            }

            try {
                const response = await fetch(`/api/admin/workflows/${workflowId}`, {
                    method: 'DELETE'
                });

                if (!response.ok) {
                    throw new Error('åˆ é™¤å·¥ä½œæµå¤±è´¥');
                }

                const result = await response.json();
                if (!result.success) {
                    throw new Error(result.error || 'åˆ é™¤å·¥ä½œæµå¤±è´¥');
                }

                showNotification(result.message || 'å·¥ä½œæµåˆ é™¤æˆåŠŸ', 'success');
                // é‡æ–°åŠ è½½å·¥ä½œæµåˆ—è¡¨
                loadWorkflowsData();

            } catch (error) {
                console.error('åˆ é™¤å·¥ä½œæµå¤±è´¥:', error);
                showNotification('åˆ é™¤å·¥ä½œæµå¤±è´¥: ' + error.message, 'error');
            }
        }

        // åˆ·æ–°å·¥ä½œæµåˆ—è¡¨
        function refreshWorkflows() {
            loadWorkflowsData();
        }

        // æ¨¡æ¿æ•°æ®åŠ è½½å‡½æ•°å·²åœ¨ä¸Šæ–¹å®šä¹‰(loadTemplatesData)

        // æ›´æ–°ç³»ç»Ÿè¿è¡Œæ—¶é—´
        function updateSystemUptime() {
            const startTime = new Date('2025-12-01T00:00:00');
            const now = new Date();
            const uptime = now - startTime;

            const days = Math.floor(uptime / (1000 * 60 * 60 * 24));
            const hours = Math.floor((uptime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((uptime % (1000 * 60 * 60)) / (1000 * 60));

            const uptimeElement = document.getElementById('systemUptime');
            if (uptimeElement) {
                uptimeElement.textContent = `${days}å¤© ${hours}å°æ—¶ ${minutes}åˆ†é’Ÿ`;
            }
        }

        // åˆ·æ–°ä»ªè¡¨æ¿
        function refreshDashboard() {
            loadDashboardData();
            showNotification('ä»ªè¡¨æ¿å·²åˆ·æ–°', 'success');
        }

        // å¯¼å‡ºæŠ¥è¡¨
        function exportReport() {
            showNotification('æŠ¥è¡¨å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        // åˆ‡æ¢å›¾è¡¨å‘¨æœŸ
        function changeChartPeriod(period) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('[data-period]').forEach(btn => {
                btn.classList.remove('active-period');
            });
            document.querySelector(`[data-period="${period}"]`).classList.add('active-period');

            // æ›´æ–°å›¾è¡¨æ•°æ®
            updateChartData(period);
        }

        // å¿«é€Ÿæ“ä½œå‡½æ•°
        function createTemplate() {
            window.open('/templates', '_blank');
        }

        function manageUsers() {
            switchSection('users');
        }

        function viewLogs() {
            showNotification('æ—¥å¿—æŸ¥çœ‹åŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        function systemSettings() {
            showNotification('ç³»ç»Ÿè®¾ç½®åŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        function addUser() {
            showNotification('æ·»åŠ ç”¨æˆ·åŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        function editUser(id) {
            showNotification(`ç¼–è¾‘ç”¨æˆ· ${id} åŠŸèƒ½å¼€å‘ä¸­...`, 'info');
        }

        function deleteUser(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤æ­¤ç”¨æˆ·å—ï¼Ÿ')) {
                showNotification(`ç”¨æˆ· ${id} å·²åˆ é™¤`, 'success');
                loadUsersData();
            }
        }

        function exportUsers() {
            showNotification('ç”¨æˆ·å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        function createTemplate() {
            window.open('/templates', '_blank');
        }

        function importTemplates() {
            showNotification('æ¨¡æ¿å¯¼å…¥åŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        async function exportAllTemplates() {
            try {
                showNotification('æ­£åœ¨å¯¼å‡ºæ¨¡æ¿æ•°æ®...', 'info');
                const response = await fetch('/api/prompt-templates');
                if (!response.ok) {
                    throw new Error('è·å–æ¨¡æ¿æ•°æ®å¤±è´¥');
                }
                const result = await response.json();
                if (!result.success) {
                    throw new Error(result.error || 'è·å–æ¨¡æ¿æ•°æ®å¤±è´¥');
                }

                // åˆ›å»ºä¸‹è½½
                const dataStr = JSON.stringify(result.data, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `prompt_templates_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                showNotification('æ¨¡æ¿å¯¼å‡ºæˆåŠŸ', 'success');
            } catch (error) {
                console.error('å¯¼å‡ºæ¨¡æ¿å¤±è´¥:', error);
                showNotification('å¯¼å‡ºæ¨¡æ¿å¤±è´¥: ' + error.message, 'error');
            }
        }

        async function refreshSystemStatus() {
            try {
                const loading = document.getElementById('systemStatusLoading');
                const content = document.getElementById('systemStatusContent');

                if (loading) loading.style.display = 'flex';
                if (content) content.style.display = 'none';

                // è°ƒç”¨çœŸå®APIè·å–ç³»ç»ŸçŠ¶æ€
                const response = await fetch('/api/admin/stats/system');
                if (!response.ok) {
                    throw new Error('è·å–ç³»ç»ŸçŠ¶æ€å¤±è´¥');
                }

                const result = await response.json();
                if (!result.success) {
                    throw new Error(result.error || 'è·å–ç³»ç»ŸçŠ¶æ€å¤±è´¥');
                }

                const status = result.data;

                if (loading) loading.style.display = 'none';
                if (content) {
                    content.style.display = 'block';
                    content.innerHTML = `
                        <div style="margin-bottom: 16px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>CPUä½¿ç”¨ç‡</span>
                                <span style="font-weight: 600;">${status.cpu}%</span>
                            </div>
                            <div class="admin-progress-bar">
                                <div class="admin-progress-fill" style="width: ${status.cpu}%"></div>
                            </div>
                        </div>
                        <div style="margin-bottom: 16px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>å†…å­˜ä½¿ç”¨ç‡</span>
                                <span style="font-weight: 600;">${status.memory}%</span>
                            </div>
                            <div class="admin-progress-bar">
                                <div class="admin-progress-fill" style="width: ${status.memory}%"></div>
                            </div>
                        </div>
                        <div style="margin-bottom: 16px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>ç£ç›˜ä½¿ç”¨ç‡</span>
                                <span style="font-weight: 600;">${status.disk}%</span>
                            </div>
                            <div class="admin-progress-bar">
                                <div class="admin-progress-fill" style="width: ${status.disk}%"></div>
                            </div>
                        </div>
                        <div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>æœåŠ¡çŠ¶æ€</span>
                                <span style="font-weight: 600; color: #10b981;">${status.service_status === 'running' ? 'è¿è¡Œä¸­' : 'å·²åœæ­¢'}</span>
                            </div>
                        </div>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e5e7eb;">
                            <div style="display: flex; justify-content: space-between; font-size: 0.875rem; color: #6b7280;">
                                <span>è¿è¡Œæ—¶é—´: ${status.uptime_days} å¤©</span>
                                <span>æ•°æ®åº“: ${status.db_size_mb} MB</span>
                            </div>
                        </div>
                    `;
                }

            } catch (error) {
                console.error('åˆ·æ–°ç³»ç»ŸçŠ¶æ€å¤±è´¥:', error);
                const loading = document.getElementById('systemStatusLoading');
                const content = document.getElementById('systemStatusContent');
                if (loading) loading.style.display = 'none';
                if (content) {
                    content.style.display = 'block';
                    content.innerHTML = '<p style="color: #ef4444;">è·å–ç³»ç»ŸçŠ¶æ€å¤±è´¥</p>';
                }
            }
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            const alertClass = type === 'success' ? 'admin-alert-success' :
                             type === 'warning' ? 'admin-alert-warning' :
                             type === 'error' ? 'admin-alert-error' : 'admin-alert-info';

            const notification = document.createElement('div');
            notification.className = `admin-alert ${alertClass}`;
            notification.innerHTML = `
                <span>${type === 'success' ? 'âœ…' : type === 'warning' ? 'âš ï¸' : type === 'error' ? 'âŒ' : 'â„¹ï¸'}</span>
                <span>${message}</span>
            `;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.style.maxWidth = '300px';

            document.body.appendChild(notification);

            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 3000);
        }

        // è‡ªåŠ¨åˆ·æ–°
        function startAutoRefresh() {
            setInterval(() => {
                if (currentSection === 'overview') {
                    loadDashboardData();
                }
            }, 60000); // æ¯åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡
        }

        // ============================================================================
        // æ—¥å¿—ç›‘æ§åŠŸèƒ½
        // ============================================================================

        // æ—¥å¿—ç›‘æ§çŠ¶æ€
        let logEventSource = null;
        let isLogStreaming = false;
        let currentLogTab = 'realtime';
        let errorTrendChart = null;
        let errorTypeChart = null;
        let perfTrendChart = null;
        let currentErrorPeriod = 24;
        let currentPerfPeriod = 24;
        let searchPage = 1;

        // åˆ‡æ¢æ—¥å¿—æ ‡ç­¾é¡µ
        function switchLogTab(tab) {
            currentLogTab = tab;

            // æ›´æ–°æ ‡ç­¾æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.log-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`.log-tab[onclick*="${tab}"]`).classList.add('active');

            // åˆ‡æ¢é¢æ¿æ˜¾ç¤º
            document.querySelectorAll('.log-panel').forEach(p => p.style.display = 'none');
            document.getElementById(`log-${tab}`).style.display = 'block';

            // åŠ è½½å¯¹åº”æ•°æ®
            switch(tab) {
                case 'realtime':
                    refreshLogs();
                    break;
                case 'errors':
                    loadErrorStats();
                    break;
                case 'performance':
                    loadPerformanceStats();
                    break;
            }
        }

        // åˆ·æ–°æ—¥å¿—
        async function refreshLogs() {
            const logFile = document.getElementById('logFileSelect').value;
            const level = document.getElementById('logLevelFilter').value;
            const logConsole = document.getElementById('logConsole');

            logConsole.innerHTML = '<div class="log-loading">æ­£åœ¨åŠ è½½æ—¥å¿—...</div>';

            try {
                const response = await fetch(`/api/admin/logs/tail?file=${logFile}&lines=200&level=${level}`);
                const data = await response.json();

                if (data.success) {
                    renderLogs(data.logs);
                    document.getElementById('logCount').textContent = `${data.logs.length} æ¡æ—¥å¿—`;
                    document.getElementById('logStatus').textContent = 'å·²åŠ è½½';
                } else {
                    logConsole.innerHTML = `<div class="log-empty-state">åŠ è½½å¤±è´¥: ${data.error}</div>`;
                }
            } catch (error) {
                logConsole.innerHTML = `<div class="log-empty-state">åŠ è½½å¤±è´¥: ${error.message}</div>`;
            }
        }

        // æ¸²æŸ“æ—¥å¿—å†…å®¹
        function renderLogs(logs) {
            const logConsole = document.getElementById('logConsole');

            if (!logs || logs.length === 0) {
                logConsole.innerHTML = '<div class="log-empty-state">æš‚æ— æ—¥å¿—</div>';
                return;
            }

            logConsole.innerHTML = logs.map(log => {
                const level = log.level || 'INFO';
                const timestamp = log.timestamp || '';
                const module = log.module || '';
                const message = escapeHtml(log.message || log.raw || '');

                return `<div class="log-line ${level}">
                    <span class="log-timestamp">${timestamp}</span>
                    <span class="log-level">${level}</span>
                    <span class="log-module">${module}</span>
                    <span class="log-message">${message}</span>
                </div>`;
            }).join('');

            // æ»šåŠ¨åˆ°åº•éƒ¨
            logConsole.scrollTop = logConsole.scrollHeight;
        }

        // åˆ‡æ¢SSEæ—¥å¿—æµ
        function toggleLogStream() {
            if (isLogStreaming) {
                stopLogStream();
            } else {
                startLogStream();
            }
        }

        // å¯åŠ¨SSEæ—¥å¿—æµ
        function startLogStream() {
            const logFile = document.getElementById('logFileSelect').value;
            const level = document.getElementById('logLevelFilter').value;

            logEventSource = new EventSource(`/api/admin/logs/stream?file=${logFile}&level=${level}`);

            logEventSource.onmessage = function(event) {
                try {
                    const log = JSON.parse(event.data);
                    appendLog(log);
                } catch (e) {
                    // å¿½ç•¥è§£æé”™è¯¯
                }
            };

            logEventSource.onerror = function() {
                if (isLogStreaming) {
                    document.getElementById('logStatus').textContent = 'è¿æ¥ä¸­æ–­ï¼Œé‡è¿ä¸­...';
                }
            };

            isLogStreaming = true;
            document.getElementById('streamBtnText').textContent = 'â¹ åœæ­¢';
            document.getElementById('logStreamBtn').classList.add('streaming');
            document.getElementById('logStatus').textContent = 'å®æ—¶ç›‘æ§ä¸­...';
        }

        // åœæ­¢SSEæ—¥å¿—æµ
        function stopLogStream() {
            if (logEventSource) {
                logEventSource.close();
                logEventSource = null;
            }

            isLogStreaming = false;
            document.getElementById('streamBtnText').textContent = 'â–¶ å¼€å§‹';
            document.getElementById('logStreamBtn').classList.remove('streaming');
            document.getElementById('logStatus').textContent = 'å·²åœæ­¢';
        }

        // è¿½åŠ å•æ¡æ—¥å¿—
        function appendLog(log) {
            const logConsole = document.getElementById('logConsole');
            const level = log.level || 'INFO';
            const timestamp = log.timestamp || '';
            const module = log.module || '';
            const message = escapeHtml(log.message || log.raw || '');

            const logLine = document.createElement('div');
            logLine.className = `log-line ${level}`;
            logLine.innerHTML = `
                <span class="log-timestamp">${timestamp}</span>
                <span class="log-level">${level}</span>
                <span class="log-module">${module}</span>
                <span class="log-message">${message}</span>
            `;

            // ç§»é™¤ç©ºçŠ¶æ€æç¤º
            const emptyState = logConsole.querySelector('.log-empty-state, .log-loading');
            if (emptyState) {
                logConsole.innerHTML = '';
            }

            logConsole.appendChild(logLine);

            // é™åˆ¶æœ€å¤§è¡Œæ•°
            while (logConsole.children.length > 500) {
                logConsole.removeChild(logConsole.firstChild);
            }

            // è‡ªåŠ¨æ»šåŠ¨
            logConsole.scrollTop = logConsole.scrollHeight;

            // æ›´æ–°è®¡æ•°
            document.getElementById('logCount').textContent = `${logConsole.children.length} æ¡æ—¥å¿—`;
        }

        // æ¸…å±
        function clearLogConsole() {
            document.getElementById('logConsole').innerHTML = '<div class="log-empty-state">æ—¥å¿—å·²æ¸…ç©º</div>';
            document.getElementById('logCount').textContent = '0 æ¡æ—¥å¿—';
        }

        // æ”¹å˜æ—¥å¿—æ–‡ä»¶
        function changeLogFile() {
            if (isLogStreaming) {
                stopLogStream();
                startLogStream();
            } else {
                refreshLogs();
            }
        }

        // æ”¹å˜æ—¥å¿—çº§åˆ«è¿‡æ»¤
        function filterLogLevel() {
            if (isLogStreaming) {
                stopLogStream();
                startLogStream();
            } else {
                refreshLogs();
            }
        }

        // æœç´¢æ—¥å¿—
        async function searchLogs() {
            const keyword = document.getElementById('searchKeyword').value.trim();
            if (!keyword) {
                showNotification('è¯·è¾“å…¥æœç´¢å…³é”®è¯', 'warning');
                return;
            }

            const file = document.getElementById('searchFile').value;
            const level = document.getElementById('searchLevel').value;
            const start = document.getElementById('searchStartTime').value;
            const end = document.getElementById('searchEndTime').value;

            const searchResults = document.getElementById('searchResults');
            searchResults.innerHTML = '<div class="log-loading">æœç´¢ä¸­...</div>';

            try {
                let url = `/api/admin/logs/search?keyword=${encodeURIComponent(keyword)}&file=${file}&level=${level}&page=${searchPage}&limit=50`;
                if (start) url += `&start=${start}`;
                if (end) url += `&end=${end}`;

                const response = await fetch(url);
                const data = await response.json();

                if (data.success) {
                    renderSearchResults(data);
                } else {
                    searchResults.innerHTML = `<div class="log-empty-state">æœç´¢å¤±è´¥: ${data.error}</div>`;
                }
            } catch (error) {
                searchResults.innerHTML = `<div class="log-empty-state">æœç´¢å¤±è´¥: ${error.message}</div>`;
            }
        }

        // æ¸²æŸ“æœç´¢ç»“æœ
        function renderSearchResults(data) {
            const searchResults = document.getElementById('searchResults');
            const pagination = document.getElementById('searchPagination');

            if (!data.logs || data.logs.length === 0) {
                searchResults.innerHTML = '<div class="log-empty-state">æœªæ‰¾åˆ°åŒ¹é…çš„æ—¥å¿—</div>';
                pagination.style.display = 'none';
                return;
            }

            searchResults.innerHTML = data.logs.map(log => {
                const level = log.level || 'INFO';
                return `<div class="log-trace-item ${level}">
                    <div><strong>${log.timestamp || ''}</strong> [${level}] ${log.module || ''}</div>
                    <div style="margin-top: 8px; color: #475569;">${escapeHtml(log.message || log.raw || '')}</div>
                </div>`;
            }).join('');

            // æ¸²æŸ“åˆ†é¡µ
            if (data.pages > 1) {
                pagination.style.display = 'flex';
                pagination.innerHTML = '';

                for (let i = 1; i <= Math.min(data.pages, 10); i++) {
                    const btn = document.createElement('button');
                    btn.className = `log-page-btn ${i === data.page ? 'active' : ''}`;
                    btn.textContent = i;
                    btn.onclick = () => { searchPage = i; searchLogs(); };
                    pagination.appendChild(btn);
                }
            } else {
                pagination.style.display = 'none';
            }
        }

        // å¯¼å‡ºæœç´¢ç»“æœ
        async function exportSearchResults() {
            const keyword = document.getElementById('searchKeyword').value.trim();
            const file = document.getElementById('searchFile').value;
            const level = document.getElementById('searchLevel').value;
            const start = document.getElementById('searchStartTime').value;
            const end = document.getElementById('searchEndTime').value;

            try {
                const response = await fetch('/api/admin/logs/export', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        file: file,
                        level: level,
                        start: start || null,
                        end: end || null,
                        format: 'txt'
                    })
                });

                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `logs_export_${new Date().toISOString().slice(0,10)}.txt`;
                    a.click();
                    window.URL.revokeObjectURL(url);
                    showNotification('æ—¥å¿—å¯¼å‡ºæˆåŠŸ', 'success');
                } else {
                    showNotification('å¯¼å‡ºå¤±è´¥', 'error');
                }
            } catch (error) {
                showNotification('å¯¼å‡ºå¤±è´¥: ' + error.message, 'error');
            }
        }

        // é”™è¯¯åˆ†ç±»é¢œè‰²æ˜ å°„
        const categoryColors = {
            'AUTH': { bg: '#fef3c7', color: '#92400e', icon: 'ğŸ”' },
            'BIZ': { bg: '#dbeafe', color: '#1e40af', icon: 'ğŸ“‹' },
            'VALID': { bg: '#fce7f3', color: '#9d174d', icon: 'âœ“' },
            'EXT': { bg: '#e0e7ff', color: '#3730a3', icon: 'ğŸŒ' },
            'SYS': { bg: '#fee2e2', color: '#991b1b', icon: 'âš™ï¸' },
            'RES': { bg: '#ccfbf1', color: '#0f766e', icon: 'ğŸ“' },
            'NET': { bg: '#f3e8ff', color: '#6b21a8', icon: 'ğŸ”—' },
            'DB': { bg: '#fef9c3', color: '#a16207', icon: 'ğŸ’¾' },
            'UNK': { bg: '#f3f4f6', color: '#374151', icon: 'â“' }
        };

        // åŠ è½½é”™è¯¯ç»Ÿè®¡
        async function loadErrorStats() {
            try {
                const response = await fetch(`/api/admin/logs/stats/errors?hours=${currentErrorPeriod}`);
                const data = await response.json();

                if (data.success) {
                    // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
                    document.getElementById('totalErrors').textContent = data.total_errors;
                    document.getElementById('criticalErrors').textContent = data.by_severity?.CRITICAL || 0;
                    document.getElementById('normalErrors').textContent = data.by_severity?.ERROR || 0;
                    document.getElementById('warningErrors').textContent = data.by_severity?.WARNING || 0;

                    // æ¸²æŸ“å›¾è¡¨
                    renderErrorTrendChart(data.trend);
                    renderErrorCategoryChart(data.by_category);
                    renderErrorCategoryStats(data.by_category);
                    renderRecentErrors(data.recent);
                }
            } catch (error) {
                console.error('åŠ è½½é”™è¯¯ç»Ÿè®¡å¤±è´¥:', error);
            }
        }

        // æ¸²æŸ“é”™è¯¯åˆ†ç±»ç»Ÿè®¡
        function renderErrorCategoryStats(categories) {
            const container = document.getElementById('errorCategoryStats');

            if (!categories || categories.length === 0) {
                container.innerHTML = '<div class="log-empty-state">æš‚æ— é”™è¯¯åˆ†ç±»æ•°æ®</div>';
                return;
            }

            container.innerHTML = categories.map(cat => {
                const style = categoryColors[cat.category] || categoryColors['UNK'];
                return `
                    <div class="error-category-card" style="background: ${style.bg}; border-left: 4px solid ${style.color};">
                        <div class="error-category-icon">${style.icon}</div>
                        <div class="error-category-info">
                            <div class="error-category-name" style="color: ${style.color};">${cat.name}</div>
                            <div class="error-category-code">${cat.category}</div>
                        </div>
                        <div class="error-category-count">
                            <span class="error-count-value">${cat.count}</span>
                            <span class="error-count-percent">${cat.percentage}%</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // æ¸²æŸ“é”™è¯¯è¶‹åŠ¿å›¾è¡¨
        function renderErrorTrendChart(trend) {
            const ctx = document.getElementById('errorTrendChart').getContext('2d');

            if (errorTrendChart) {
                errorTrendChart.destroy();
            }

            errorTrendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: trend.labels,
                    datasets: [{
                        label: 'é”™è¯¯æ•°',
                        data: trend.data,
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        // æ¸²æŸ“é”™è¯¯åˆ†ç±»åˆ†å¸ƒå›¾è¡¨
        function renderErrorCategoryChart(categories) {
            const ctx = document.getElementById('errorTypeChart').getContext('2d');

            if (errorTypeChart) {
                errorTypeChart.destroy();
            }

            if (!categories || categories.length === 0) {
                return;
            }

            const labels = categories.map(c => c.name);
            const data = categories.map(c => c.count);
            const colors = categories.map(c => {
                const style = categoryColors[c.category] || categoryColors['UNK'];
                return style.color;
            });

            errorTypeChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: colors
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                generateLabels: function(chart) {
                                    const data = chart.data;
                                    return data.labels.map((label, i) => ({
                                        text: `${label} (${data.datasets[0].data[i]})`,
                                        fillStyle: data.datasets[0].backgroundColor[i],
                                        hidden: false,
                                        index: i
                                    }));
                                }
                            }
                        }
                    }
                }
            });
        }

        // æ¸²æŸ“æœ€è¿‘é”™è¯¯åˆ—è¡¨
        function renderRecentErrors(errors) {
            const container = document.getElementById('recentErrors');

            if (!errors || errors.length === 0) {
                container.innerHTML = '<div class="log-empty-state">æš‚æ— é”™è¯¯</div>';
                return;
            }

            container.innerHTML = errors.map(error => {
                const style = categoryColors[error.category] || categoryColors['UNK'];
                const severityClass = error.severity === 'CRITICAL' ? 'severity-critical' :
                                     error.severity === 'ERROR' ? 'severity-error' : 'severity-warning';
                return `
                    <div class="log-error-item ${severityClass}">
                        <div class="log-error-header">
                            <div class="error-badges">
                                <span class="error-code-badge" style="background: ${style.bg}; color: ${style.color};">${error.code}</span>
                                <span class="error-category-badge" style="background: ${style.bg}; color: ${style.color};">${error.category_name}</span>
                                <span class="error-severity-badge ${severityClass}">${error.severity}</span>
                            </div>
                            <span class="log-error-time">${error.timestamp || ''}</span>
                        </div>
                        <div class="log-error-name">${escapeHtml(error.name || '')}</div>
                        <div class="log-error-message">${escapeHtml(error.message || '')}</div>
                        ${error.solution ? `<div class="log-error-solution">ğŸ’¡ ${escapeHtml(error.solution)}</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        // æ”¹å˜é”™è¯¯ç»Ÿè®¡å‘¨æœŸ
        function changeErrorPeriod(hours) {
            currentErrorPeriod = hours;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('#log-errors .admin-card-action').forEach(btn => {
                btn.classList.remove('active-period');
                if (btn.textContent.includes(hours === 24 ? '24å°æ—¶' : hours === 72 ? '3å¤©' : '7å¤©')) {
                    btn.classList.add('active-period');
                }
            });

            loadErrorStats();
        }

        // åŠ è½½æ€§èƒ½ç»Ÿè®¡
        async function loadPerformanceStats() {
            try {
                const response = await fetch(`/api/admin/logs/stats/performance?hours=${currentPerfPeriod}`);
                const data = await response.json();

                if (data.success) {
                    document.getElementById('totalRequests').textContent = data.total_requests;
                    document.getElementById('avgResponseTime2').textContent = `${(data.avg_response_time * 1000).toFixed(0)}ms`;
                    document.getElementById('p95ResponseTime').textContent = `${(data.p95_response_time * 1000).toFixed(0)}ms`;
                    document.getElementById('slowRequests').textContent = data.slow_requests;

                    renderPerfTrendChart(data.trend);
                    renderEndpointTable(data.by_endpoint);

                    // åŠ è½½æ…¢æŸ¥è¯¢
                    loadSlowQueries();
                }
            } catch (error) {
                console.error('åŠ è½½æ€§èƒ½ç»Ÿè®¡å¤±è´¥:', error);
            }
        }

        // åŠ è½½æ…¢æŸ¥è¯¢
        async function loadSlowQueries() {
            try {
                const response = await fetch(`/api/admin/logs/stats/slow?hours=${currentPerfPeriod}`);
                const data = await response.json();

                if (data.success) {
                    renderSlowQueryList(data.top_slow);
                }
            } catch (error) {
                console.error('åŠ è½½æ…¢æŸ¥è¯¢å¤±è´¥:', error);
            }
        }

        // æ¸²æŸ“æ€§èƒ½è¶‹åŠ¿å›¾è¡¨
        function renderPerfTrendChart(trend) {
            const ctx = document.getElementById('perfTrendChart').getContext('2d');

            if (perfTrendChart) {
                perfTrendChart.destroy();
            }

            perfTrendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: trend.labels,
                    datasets: [{
                        label: 'å¹³å‡å“åº”æ—¶é—´ (ç§’)',
                        data: trend.avg_times,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        // æ¸²æŸ“ç«¯ç‚¹æ€§èƒ½è¡¨æ ¼
        function renderEndpointTable(endpoints) {
            const tbody = document.querySelector('#endpointPerfTable tbody');

            if (!endpoints || endpoints.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="log-empty-state">æš‚æ— æ•°æ®</td></tr>';
                return;
            }

            tbody.innerHTML = endpoints.map(ep => `
                <tr>
                    <td>${escapeHtml(ep.endpoint)}</td>
                    <td>${ep.count}</td>
                    <td>${(ep.avg * 1000).toFixed(0)}ms</td>
                    <td>${(ep.p95 * 1000).toFixed(0)}ms</td>
                    <td>${(ep.max * 1000).toFixed(0)}ms</td>
                </tr>
            `).join('');
        }

        // æ¸²æŸ“æ…¢æŸ¥è¯¢åˆ—è¡¨
        function renderSlowQueryList(queries) {
            const container = document.getElementById('slowQueryList');

            if (!queries || queries.length === 0) {
                container.innerHTML = '<div class="log-empty-state">æš‚æ— æ…¢æŸ¥è¯¢</div>';
                return;
            }

            container.innerHTML = queries.slice(0, 10).map(q => `
                <div class="log-slow-item">
                    <span class="log-slow-operation">${escapeHtml(q.operation)}</span>
                    <span class="log-slow-duration">${q.duration.toFixed(2)}s</span>
                </div>
            `).join('');
        }

        // æ”¹å˜æ€§èƒ½ç»Ÿè®¡å‘¨æœŸ
        function changePerfPeriod(hours) {
            currentPerfPeriod = hours;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('#log-performance .admin-card-action').forEach(btn => {
                btn.classList.remove('active-period');
                if (btn.textContent.includes(hours === 24 ? '24å°æ—¶' : hours === 72 ? '3å¤©' : '7å¤©')) {
                    btn.classList.add('active-period');
                }
            });

            loadPerformanceStats();
        }

        // è¯·æ±‚è¿½è¸ª
        async function traceRequest() {
            const requestId = document.getElementById('traceRequestId').value.trim();
            if (!requestId) {
                showNotification('è¯·è¾“å…¥è¯·æ±‚ID', 'warning');
                return;
            }

            const traceResults = document.getElementById('traceResults');
            traceResults.innerHTML = '<div class="log-loading">è¿½è¸ªä¸­...</div>';

            try {
                const response = await fetch(`/api/admin/logs/request/${requestId}`);
                const data = await response.json();

                if (data.success) {
                    if (data.logs && data.logs.length > 0) {
                        traceResults.innerHTML = data.logs.map(log => {
                            const level = log.level || 'INFO';
                            return `<div class="log-trace-item ${level}">
                                <div><strong>${log.timestamp || ''}</strong> [${level}] ${log.module || ''}</div>
                                <div style="margin-top: 8px; color: #475569;">${escapeHtml(log.message || log.raw || '')}</div>
                            </div>`;
                        }).join('');
                    } else {
                        traceResults.innerHTML = `<div class="log-empty-state">æœªæ‰¾åˆ°è¯·æ±‚ID: ${requestId}</div>`;
                    }
                } else {
                    traceResults.innerHTML = `<div class="log-empty-state">è¿½è¸ªå¤±è´¥: ${data.error}</div>`;
                }
            } catch (error) {
                traceResults.innerHTML = `<div class="log-empty-state">è¿½è¸ªå¤±è´¥: ${error.message}</div>`;
            }
        }

        // HTMLè½¬ä¹‰
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // æ—¥å¿—éƒ¨åˆ†åŠ è½½æ—¶åˆå§‹åŒ–
        function initLogSection() {
            refreshLogs();
        }
    </script>

    <!-- ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤ºè„šæœ¬ -->
    <script src="/static/auth_utils.js"></script>
    <script src="/static/user_display.js"></script>
    <script>
        // ä¸ºç®¡ç†æ§åˆ¶å°å®šä¹‰ç™»å½•ç‚¹å‡»å¤„ç†å‡½æ•°
        function handleLoginClick() {
            window.location.href = '/login';
        }

        // ç¡®ä¿ç”¨æˆ·æ˜¾ç¤ºåœ¨ç®¡ç†æ§åˆ¶å°ä¸­æ­£å¸¸å·¥ä½œ
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–ç”¨æˆ·æ˜¾ç¤º
            if (typeof userDisplay !== 'undefined') {
                userDisplay.init();
            }
        });
    </script>
</body>
</html>