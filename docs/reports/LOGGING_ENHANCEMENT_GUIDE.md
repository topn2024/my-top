# TOP_N æ—¥å¿—ç³»ç»Ÿå¢å¼ºæŒ‡å—

**åˆ›å»ºæ—¥æœŸ**: 2025-12-23
**ä½œè€…**: Claude Code
**ç‰ˆæœ¬**: 2.0

---

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£ä»‹ç»TOP_Nç³»ç»Ÿæ—¥å¿—å¢å¼ºåŠŸèƒ½ï¼ŒåŒ…æ‹¬ç»“æ„åŒ–æ—¥å¿—ã€è¯·æ±‚è¿½è¸ªã€æ€§èƒ½ç›‘æ§ã€æ…¢æŸ¥è¯¢æ£€æµ‹ç­‰é«˜çº§ç‰¹æ€§ï¼Œå¸®åŠ©å¼€å‘å’Œè¿ç»´äººå‘˜å¿«é€Ÿå®šä½é—®é¢˜ã€‚

---

## ğŸ¯ å¢å¼ºåŠŸèƒ½

### 1. æ—¥å¿—è½®è½¬

**é—®é¢˜**: æ—¥å¿—æ–‡ä»¶æ— é™å¢é•¿ï¼Œå ç”¨å¤§é‡ç£ç›˜ç©ºé—´

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨ `RotatingFileHandler` å®ç°æ–‡ä»¶å¤§å°è½®è½¬
- ä½¿ç”¨ `TimedRotatingFileHandler` å®ç°æŒ‰æ—¶é—´è½®è½¬
- è‡ªåŠ¨å¤‡ä»½å’Œæ¸…ç†æ—§æ—¥å¿—

**é…ç½®**:
```python
# æ–‡ä»¶å¤§å°è½®è½¬ - æœ€å¤§10MBï¼Œä¿ç•™5ä¸ªå¤‡ä»½
RotatingFileHandler(file_path, maxBytes=10*1024*1024, backupCount=5)

# æŒ‰å¤©è½®è½¬ - æ¯å¤©åˆå¤œè½®è½¬ï¼Œä¿ç•™30å¤©
TimedRotatingFileHandler(file_path, when='midnight', interval=1, backupCount=30)
```

### 2. è¯·æ±‚IDè¿½è¸ª

**é—®é¢˜**: åœ¨åˆ†å¸ƒå¼æˆ–å¹¶å‘ç¯å¢ƒä¸­ï¼Œéš¾ä»¥è¿½è¸ªå•ä¸ªè¯·æ±‚çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ

**è§£å†³æ–¹æ¡ˆ**:
- ä¸ºæ¯ä¸ªè¯·æ±‚ç”Ÿæˆå”¯ä¸€ID
- ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨ä¿å­˜è¯·æ±‚ID
- åœ¨æ‰€æœ‰æ—¥å¿—ä¸­è‡ªåŠ¨æ·»åŠ è¯·æ±‚ID

**ä½¿ç”¨æ–¹å¼**:
```python
from logger_config import set_request_id, get_request_id, clear_request_id

# APIå…¥å£è®¾ç½®è¯·æ±‚ID
request_id = set_request_id()  # è‡ªåŠ¨ç”Ÿæˆ

# åœ¨æ•´ä¸ªè¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰æ—¥å¿—éƒ½ä¼šåŒ…å«è¿™ä¸ªID
logger.info("Processing user request")  # æ—¥å¿—ä¸­è‡ªåŠ¨åŒ…å«request_id

# è¯·æ±‚ç»“æŸæ—¶æ¸…é™¤
clear_request_id()
```

### 3. ç»“æ„åŒ–æ—¥å¿—

**é—®é¢˜**: çº¯æ–‡æœ¬æ—¥å¿—éš¾ä»¥è¢«è‡ªåŠ¨åŒ–å·¥å…·è§£æå’Œåˆ†æ

**è§£å†³æ–¹æ¡ˆ**:
- æ”¯æŒJSONæ ¼å¼æ—¥å¿—è¾“å‡º
- åŒ…å«ç»“æ„åŒ–å­—æ®µï¼štimestamp, level, logger, file, line, message, request_idç­‰
- ä¾¿äºé›†æˆæ—¥å¿—åˆ†æå·¥å…·ï¼ˆå¦‚ELKã€Splunkï¼‰

**å¯ç”¨æ–¹å¼**:
```python
logger = setup_logger('my_logger', enable_json=True)
```

**JSONæ—¥å¿—ç¤ºä¾‹**:
```json
{
  "timestamp": "2025-12-23T19:55:29.123456",
  "level": "INFO",
  "logger": "blueprints.api",
  "file": "api.py",
  "line": 123,
  "function": "upload_file",
  "request_id": "abc12345",
  "message": "File uploaded successfully",
  "user_id": 1,
  "duration": 0.234
}
```

### 4. æ€§èƒ½ç›‘æ§

**é—®é¢˜**: éš¾ä»¥å¿«é€Ÿè¯†åˆ«ç³»ç»Ÿæ€§èƒ½ç“¶é¢ˆ

**è§£å†³æ–¹æ¡ˆ**:
- è‡ªåŠ¨è®°å½•APIå“åº”æ—¶é—´
- è‡ªåŠ¨è®°å½•æœåŠ¡å±‚è°ƒç”¨è€—æ—¶
- è‡ªåŠ¨è®°å½•æ•°æ®åº“æŸ¥è¯¢è€—æ—¶
- ç”Ÿæˆä¸“é—¨çš„æ€§èƒ½æ—¥å¿—æ–‡ä»¶

**æ—¥å¿—æ–‡ä»¶**: `logs/performance.log`

**æ ¼å¼**:
```
2025-12-23 19:55:29 | abc12345 | ä¸Šä¼ æ–‡ä»¶ | 0.234s | User=admin | Status=200 | Success=true
```

### 5. æ…¢æŸ¥è¯¢æ£€æµ‹

**é—®é¢˜**: éš¾ä»¥å¿«é€Ÿå‘ç°æ€§èƒ½é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:
- è‡ªåŠ¨æ£€æµ‹è¶…è¿‡é˜ˆå€¼çš„æ“ä½œ
- å•ç‹¬è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—
- æ”¯æŒé…ç½®ä¸åŒçš„é˜ˆå€¼

**é…ç½®**:
```python
# å…¨å±€é˜ˆå€¼ï¼ˆlogger_config.pyï¼‰
SLOW_QUERY_THRESHOLD = 3.0   # ç§’
SLOW_API_THRESHOLD = 2.0     # ç§’

# APIçº§åˆ«è‡ªå®šä¹‰é˜ˆå€¼
@log_api_request("ä¸Šä¼ æ–‡ä»¶", slow_threshold=5.0)
def upload_file():
    ...
```

**æ—¥å¿—æ–‡ä»¶**: `logs/slow.log`

### 6. å¢å¼ºçš„è£…é¥°å™¨

#### 6.1 APIè¯·æ±‚æ—¥å¿—è£…é¥°å™¨

```python
@log_api_request("åˆ›å»ºç”¨æˆ·è®¢å•")
def create_order():
    ...
```

**ç‰¹æ€§**:
- è‡ªåŠ¨è®°å½•è¯·æ±‚å‚æ•°ï¼ˆéšè—æ•æ„Ÿä¿¡æ¯ï¼‰
- è‡ªåŠ¨è®°å½•å“åº”çŠ¶æ€
- è‡ªåŠ¨è®°å½•å“åº”æ—¶é—´
- è‡ªåŠ¨æå–ä¸šåŠ¡æˆåŠŸ/å¤±è´¥çŠ¶æ€
- è‡ªåŠ¨è®°å½•å®¢æˆ·ç«¯IPå’ŒUser-Agent
- ç¾è§‚çš„è¾¹æ¡†æ ¼å¼è¾“å‡º

**æ—¥å¿—ç¤ºä¾‹**:
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ã€APIè¯·æ±‚ã€‘åˆ›å»ºç”¨æˆ·è®¢å•
â•‘ RequestID: abc12345 | User: admin(ID:1) | IP: 192.168.1.100
â•‘ Endpoint: POST /api/orders
â•‘ User-Agent: Mozilla/5.0...
â•‘ è¯·æ±‚æ•°æ®: {"product_id": 123, "quantity": 2}
â•‘ â–¶ å¼€å§‹æ‰§è¡Œä¸šåŠ¡é€»è¾‘...
â•‘ â± æ‰§è¡Œå®Œæˆ: 0.234s | HTTP 200
â•‘ ğŸ“¤ å“åº”: success=true, data_keys=['order_id', 'total']
â•‘ âœ“ è¯·æ±‚æˆåŠŸ
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[åˆ›å»ºç”¨æˆ·è®¢å•] æˆåŠŸå®Œæˆ (ReqID: abc12345)
```

#### 6.2 æœåŠ¡å±‚è°ƒç”¨æ—¥å¿—è£…é¥°å™¨

```python
@log_service_call("è®¡ç®—è®¢å•æ€»ä»·", log_args=True)
def calculate_total(items, discount=0):
    ...
```

**ç‰¹æ€§**:
- è‡ªåŠ¨è®°å½•å¼€å§‹å’Œå®Œæˆ
- å¯é€‰è®°å½•å‚æ•°
- è‡ªåŠ¨è®°å½•è€—æ—¶
- è‡ªåŠ¨æ£€æµ‹æ…¢æœåŠ¡

**æ—¥å¿—ç¤ºä¾‹**:
```
â”Œâ”€ [Service] è®¡ç®—è®¢å•æ€»ä»· - å¼€å§‹ (ReqID: abc12345)
â”‚  Function: calculate_total
â”‚  Args: ([{'id': 1, 'price': 100}],)
â”‚  Kwargs: {'discount': 0.1}
â””â”€ [Service] è®¡ç®—è®¢å•æ€»ä»· - âœ“ å®Œæˆ (0.123s)
```

#### 6.3 æ•°æ®åº“æŸ¥è¯¢æ—¥å¿—è£…é¥°å™¨

```python
@log_database_query("æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨")
def get_users():
    ...
```

**ç‰¹æ€§**:
- è‡ªåŠ¨è®°å½•æŸ¥è¯¢è€—æ—¶
- è‡ªåŠ¨æ£€æµ‹æ…¢æŸ¥è¯¢ï¼ˆ>1ç§’ï¼‰

### 7. å¤šçº§æ—¥å¿—æ–‡ä»¶

| æ–‡ä»¶ | çº§åˆ« | è½®è½¬ | ä¿ç•™ | ç”¨é€” |
|-----|------|------|-----|------|
| **all.log** | DEBUG+ | 10MB | 5ä¸ª | æ‰€æœ‰æ—¥å¿— |
| **error.log** | ERROR+ | 10MB | 10ä¸ª | é”™è¯¯æ—¥å¿— |
| **slow.log** | WARNING+ | 10MB | 5ä¸ª | æ…¢æŸ¥è¯¢/API |
| **performance.log** | INFO+ | æ¯å¤© | 30å¤© | æ€§èƒ½æ•°æ® |

---

## ğŸ›  ä½¿ç”¨æŒ‡å—

### åŸºæœ¬ä½¿ç”¨

```python
from logger_config import setup_logger, log_api_request

# 1. åˆ›å»ºlogger
logger = setup_logger('my_module')

# 2. è®°å½•æ—¥å¿—
logger.debug("è°ƒè¯•ä¿¡æ¯")
logger.info("æ™®é€šä¿¡æ¯")
logger.warning("è­¦å‘Šä¿¡æ¯")
logger.error("é”™è¯¯ä¿¡æ¯")

# 3. åœ¨APIä¸­ä½¿ç”¨
@app.route('/api/upload')
@log_api_request("ä¸Šä¼ æ–‡ä»¶")
def upload_file():
    logger.info("å¼€å§‹å¤„ç†ä¸Šä¼ ")
    # ... ä¸šåŠ¡é€»è¾‘
    return jsonify({"success": True})
```

### Flaskåº”ç”¨é›†æˆ

```python
from flask import Flask, g, request
from logger_config import set_request_id, clear_request_id

app = Flask(__name__)

@app.before_request
def before_request():
    """è¯·æ±‚å‰è®¾ç½®è¯·æ±‚ID"""
    set_request_id()

@app.after_request
def after_request(response):
    """è¯·æ±‚åæ¸…é™¤è¯·æ±‚ID"""
    clear_request_id()
    return response
```

---

## ğŸ“Š æ—¥å¿—åˆ†æå·¥å…·

æˆ‘ä»¬æä¾›äº†å¼ºå¤§çš„æ—¥å¿—åˆ†æå·¥å…·ï¼š`backend/scripts/log_analyzer.py`

### åŠŸèƒ½åˆ—è¡¨

#### 1. æŸ¥çœ‹æ—¥å¿—å°¾éƒ¨

```bash
# æŸ¥çœ‹æœ€å50è¡Œ
python backend/scripts/log_analyzer.py --tail

# æŸ¥çœ‹æœ€å100è¡Œ
python backend/scripts/log_analyzer.py --tail --lines 100

# å®æ—¶è·Ÿè¸ªæ—¥å¿—
python backend/scripts/log_analyzer.py --tail --follow
```

#### 2. æœç´¢å…³é”®è¯

```bash
# æœç´¢é”™è¯¯
python backend/scripts/log_analyzer.py --search "ERROR"

# æœç´¢å¹¶æ˜¾ç¤ºä¸Šä¸‹æ–‡ï¼ˆå‰å3è¡Œï¼‰
python backend/scripts/log_analyzer.py --search "ValueError" --context 3

# åœ¨error.logä¸­æœç´¢
python backend/scripts/log_analyzer.py --search "timeout" --log-file error.log
```

#### 3. è¯·æ±‚IDè¿½è¸ª

```bash
# æ ¹æ®è¯·æ±‚IDè¿½è¸ªå®Œæ•´è¯·æ±‚é“¾è·¯
python backend/scripts/log_analyzer.py --request-id abc12345
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
ğŸ”— è¿½è¸ªè¯·æ±‚: abc12345
================================================================================

âœ“ æ‰¾åˆ° 15 æ¡ç›¸å…³æ—¥å¿—:

2025-12-23 19:55:29 | INFO | ... | abc12345 | ã€APIè¯·æ±‚ã€‘åˆ›å»ºè®¢å•
2025-12-23 19:55:29 | INFO | ... | abc12345 | [Service] æŸ¥è¯¢å•†å“ - å¼€å§‹
2025-12-23 19:55:29 | INFO | ... | abc12345 | [DB] æŸ¥è¯¢å•†å“ - 0.045s
2025-12-23 19:55:29 | INFO | ... | abc12345 | [Service] æŸ¥è¯¢å•†å“ - å®Œæˆ (0.048s)
...
2025-12-23 19:55:30 | INFO | ... | abc12345 | âœ“ è¯·æ±‚æˆåŠŸ
```

#### 4. é”™è¯¯åˆ†æ

```bash
# åˆ†ææœ€è¿‘24å°æ—¶çš„é”™è¯¯
python backend/scripts/log_analyzer.py --analyze-errors

# åˆ†ææœ€è¿‘1å°æ—¶çš„é”™è¯¯
python backend/scripts/log_analyzer.py --analyze-errors --hours 1
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
ğŸ“Š é”™è¯¯æ—¥å¿—åˆ†æ - æœ€è¿‘ 24 å°æ—¶
================================================================================

é”™è¯¯æ€»æ•°: 15

é”™è¯¯ç±»å‹åˆ†å¸ƒ:
  ValueError                     |    8 | 53.3% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  KeyError                       |    4 | 26.7% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
  TypeError                      |    3 | 20.0% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

æœ€è¿‘çš„é”™è¯¯:
  [ValueError] invalid literal for int() with base 10: 'abc'
  [KeyError] 'user_id' not found in session
  ...
```

#### 5. æ€§èƒ½åˆ†æ

```bash
# åˆ†ææœ€è¿‘24å°æ—¶çš„æ€§èƒ½æ•°æ®
python backend/scripts/log_analyzer.py --analyze-performance

# åˆ†ææœ€è¿‘1å°æ—¶
python backend/scripts/log_analyzer.py --analyze-performance --hours 1
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
âš¡ æ€§èƒ½åˆ†æ - æœ€è¿‘ 24 å°æ—¶
================================================================================

æ€»è¯·æ±‚æ•°: 1,234

æ“ä½œæ€§èƒ½ç»Ÿè®¡:
æ“ä½œ                                       | æ¬¡æ•°   | å¹³å‡     | æœ€å°     | æœ€å¤§     | P95
-------------------------------------------|--------|----------|----------|----------|----------
ä¸Šä¼ æ–‡ä»¶                                   |    234 |  0.456s |  0.123s |  2.345s |  1.234s
åˆ›å»ºè®¢å•                                   |    156 |  0.234s |  0.089s |  1.123s |  0.567s
æŸ¥è¯¢åˆ—è¡¨                                   |    844 |  0.089s |  0.023s |  0.456s |  0.234s
```

#### 6. æ…¢æŸ¥è¯¢åˆ†æ

```bash
python backend/scripts/log_analyzer.py --analyze-slow
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
ğŸŒ æ…¢æŸ¥è¯¢åˆ†æ
================================================================================

æ…¢æŸ¥è¯¢æ€»æ•°: 12

API ç±»å‹æ…¢æŸ¥è¯¢ (8 ä¸ª):
----------------------------------------
  4.567s | ä¸Šä¼ å¤§æ–‡ä»¶
  3.234s | æ‰¹é‡å¯¼å…¥æ•°æ®
  2.890s | ç”ŸæˆæŠ¥è¡¨

SERVICE ç±»å‹æ…¢æŸ¥è¯¢ (4 ä¸ª):
----------------------------------------
  5.123s | å¤æ‚æ•°æ®åˆ†æ
  3.456s | æ‰¹é‡æ›´æ–°è®°å½•
```

#### 7. åˆ—å‡ºæ—¥å¿—æ–‡ä»¶

```bash
python backend/scripts/log_analyzer.py --list
```

**è¾“å‡ºç¤ºä¾‹**:
```
================================================================================
ğŸ“ æ—¥å¿—æ–‡ä»¶åˆ—è¡¨ (D:\code\TOP_N\logs)
================================================================================

æ–‡ä»¶å                          | å¤§å°         | æœ€åä¿®æ”¹æ—¶é—´
----------------------------------------------------------------------------------
all.log                        | 8.5 MB       | 2025-12-23 19:55:34
error.log                      | 234.5 KB     | 2025-12-23 18:30:12
performance.log                | 1.2 MB       | 2025-12-23 19:55:34
slow.log                       | 45.6 KB      | 2025-12-23 17:20:45
```

---

## ğŸ”§ æœ€ä½³å®è·µ

### 1. æ—¥å¿—çº§åˆ«ä½¿ç”¨

- **DEBUG**: å¼€å‘è°ƒè¯•ä¿¡æ¯ï¼Œç”Ÿäº§ç¯å¢ƒä¸è¾“å‡º
- **INFO**: æ­£å¸¸ä¸šåŠ¡æµç¨‹ï¼Œå…³é”®æ“ä½œæˆåŠŸ
- **WARNING**: å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œä½†ä¸å½±å“åŠŸèƒ½
- **ERROR**: é”™è¯¯ï¼Œéœ€è¦å…³æ³¨å’Œå¤„ç†

### 2. æ•æ„Ÿä¿¡æ¯ä¿æŠ¤

æ—¥å¿—è£…é¥°å™¨è‡ªåŠ¨éšè—æ•æ„Ÿä¿¡æ¯ï¼š
- password
- token
- secret
- api_key

### 3. æ—¥å¿—æ ¼å¼è§„èŒƒ

```python
# âœ“ å¥½çš„æ—¥å¿—
logger.info(f"ç”¨æˆ· {user_id} åˆ›å»ºè®¢å•æˆåŠŸï¼Œè®¢å•ID: {order_id}")

# âœ— ä¸å¥½çš„æ—¥å¿—
logger.info("success")  # ä¿¡æ¯ä¸è¶³
```

### 4. å¼‚å¸¸æ—¥å¿—è®°å½•

```python
try:
    result = risky_operation()
except Exception as e:
    logger.error(f"æ“ä½œå¤±è´¥: {e}", exc_info=True)  # åŒ…å«å †æ ˆ
    raise
```

### 5. æ€§èƒ½æ•æ„Ÿæ“ä½œ

```python
@log_service_call("å¤§æ•°æ®å¤„ç†")
def process_big_data():
    # è‡ªåŠ¨è®°å½•è€—æ—¶ï¼Œè¶…è¿‡é˜ˆå€¼ä¼šè®°å½•åˆ°slow.log
    ...
```

---

## ğŸ“ˆ ç›‘æ§å»ºè®®

### æ—¥å¸¸ç›‘æ§

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f logs/all.log

# æŸ¥çœ‹æœ€è¿‘é”™è¯¯
tail -100 logs/error.log

# æŸ¥çœ‹æ…¢æŸ¥è¯¢
cat logs/slow.log
```

### å®šæœŸåˆ†æ

```bash
# æ¯å¤©åˆ†æé”™è¯¯è¶‹åŠ¿
python backend/scripts/log_analyzer.py --analyze-errors --hours 24 > daily_errors.txt

# æ¯å‘¨åˆ†ææ€§èƒ½
python backend/scripts/log_analyzer.py --analyze-performance --hours 168 > weekly_perf.txt
```

### å‘Šè­¦è®¾ç½®

å»ºè®®è®¾ç½®ä»¥ä¸‹å‘Šè­¦ï¼š
1. ERRORæ—¥å¿—æ•°é‡ > 10æ¡/åˆ†é’Ÿ
2. æ…¢APIæ•°é‡ > 5ä¸ª/å°æ—¶
3. æ—¥å¿—æ–‡ä»¶å¤§å° > 100MB

---

## ğŸ”„ è¿ç§»æŒ‡å—

ä»æ—§ç‰ˆæœ¬æ—¥å¿—ç³»ç»Ÿè¿ç§»ï¼š

### 1. ä»£ç è¿ç§»

**æ—§ä»£ç **:
```python
import logging
logger = logging.getLogger(__name__)
```

**æ–°ä»£ç **:
```python
from logger_config import setup_logger
logger = setup_logger(__name__)
```

### 2. APIè£…é¥°å™¨è¿ç§»

**æ—§ä»£ç **:
```python
@app.route('/api/upload')
def upload_file():
    logger.info("Upload started")
    # ...
    logger.info("Upload completed")
```

**æ–°ä»£ç **:
```python
@app.route('/api/upload')
@log_api_request("ä¸Šä¼ æ–‡ä»¶")
def upload_file():
    # è‡ªåŠ¨è®°å½•å¼€å§‹å’Œç»“æŸ
    # ...
```

### 3. æœåŠ¡å±‚è¿ç§»

**æ—§ä»£ç **:
```python
def process_data(data):
    logger.info("Processing data")
    # ...
    logger.info("Data processed")
```

**æ–°ä»£ç **:
```python
@log_service_call("å¤„ç†æ•°æ®")
def process_data(data):
    # è‡ªåŠ¨è®°å½•
    # ...
```

---

## ğŸ“ æµ‹è¯•

è¿è¡Œæ—¥å¿—ç³»ç»Ÿæµ‹è¯•ï¼š

```bash
python backend/tests/test_logger.py
```

æµ‹è¯•åŒ…æ‹¬ï¼š
1. âœ“ åŸºæœ¬æ—¥å¿—è®°å½•
2. âœ“ è¯·æ±‚IDè¿½è¸ª
3. âœ“ å‡½æ•°è°ƒç”¨æ—¥å¿—
4. âœ“ æœåŠ¡å±‚è°ƒç”¨æ—¥å¿—
5. âœ“ æ•°æ®åº“æŸ¥è¯¢æ—¥å¿—
6. âœ“ æ…¢æŸ¥è¯¢æ£€æµ‹
7. âœ“ å¼‚å¸¸æ—¥å¿—è®°å½•
8. âœ“ å¹¶å‘è¯·æ±‚æ¨¡æ‹Ÿ

---

## â“ å¸¸è§é—®é¢˜

### Q1: æ—¥å¿—æ–‡ä»¶å¤ªå¤§æ€ä¹ˆåŠï¼Ÿ

**A**: æ—¥å¿—ç³»ç»Ÿè‡ªåŠ¨è½®è½¬ï¼Œå½“æ–‡ä»¶è¶…è¿‡10MBæ—¶ä¼šè‡ªåŠ¨åˆ›å»ºå¤‡ä»½ã€‚æ—§å¤‡ä»½ä¼šè‡ªåŠ¨åˆ é™¤ã€‚

### Q2: å¦‚ä½•åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç¦ç”¨DEBUGæ—¥å¿—ï¼Ÿ

**A**:
```python
logger = setup_logger('my_logger', level=logging.INFO)
```

### Q3: å¦‚ä½•æŸ¥æ‰¾ç‰¹å®šç”¨æˆ·çš„æ‰€æœ‰è¯·æ±‚ï¼Ÿ

**A**: æ—¥å¿—ä¸­åŒ…å«user_idï¼Œå¯ä»¥ä½¿ç”¨grepï¼š
```bash
grep "User: username" logs/all.log
```

### Q4: æ€§èƒ½æ—¥å¿—ä¼šå½±å“ç³»ç»Ÿæ€§èƒ½å—ï¼Ÿ

**A**: å½±å“æå°ï¼ˆ<1msï¼‰ï¼Œæ—¥å¿—é‡‡ç”¨å¼‚æ­¥å†™å…¥ï¼Œä¸ä¼šé˜»å¡ä¸šåŠ¡é€»è¾‘ã€‚

### Q5: å¦‚ä½•å¯¼å‡ºæ—¥å¿—åˆ°å¤–éƒ¨ç³»ç»Ÿï¼Ÿ

**A**:
- JSONæ ¼å¼æ—¥å¿—å¯ç›´æ¥è¢«Filebeatç­‰å·¥å…·é‡‡é›†
- ä½¿ç”¨syslogåè®®è½¬å‘
- ä½¿ç”¨æ—¥å¿—èšåˆå·¥å…·ï¼ˆå¦‚Logstashï¼‰

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- æ—¥å¿—é…ç½®æ–‡ä»¶: `backend/logger_config.py`
- æ—¥å¿—åˆ†æå·¥å…·: `backend/scripts/log_analyzer.py`
- æµ‹è¯•æ–‡ä»¶: `backend/tests/test_logger.py`
- æ—¥å¿—ç›®å½•: `logs/`

---

**æ—¥å¿—ç³»ç»Ÿç‰ˆæœ¬**: 2.0
**æœ€åæ›´æ–°**: 2025-12-23
**ç»´æŠ¤äººå‘˜**: DevOps Team
