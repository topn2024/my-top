# Python 开发和 AI 库升级指南

## 升级时间
2025-12-05

## Python 环境
- **Python 版本**: 3.10.6
- **pip 版本**: 25.3 (已升级)
- **操作系统**: Windows

---

## 正在升级的库

### 1. 核心开发工具 ✅
- **pip**: 25.2 → 25.3
- **setuptools**: 63.2.0 → 80.9.0
- **wheel**: 最新版本

### 2. AI/ML 核心库 (升级中)
- **numpy**: 1.24.3 → 2.2.6
- **pandas**: 最新版本
- **scikit-learn**: 最新版本
- **scipy**: 最新版本
- **matplotlib**: 最新版本
- **seaborn**: 最新版本
- **pillow**: 最新版本

### 3. Web 开发框架 (升级中)
- **flask**: 2.3.2 → 3.1.2
- **flask-cors**: 最新版本
- **requests**: 最新版本
- **aiohttp**: 最新版本
- **fastapi**: 最新版本
- **uvicorn**: 最新版本

### 4. NLP 和 LLM 库 (升级中)
- **transformers**: 最新版本
- **openai**: 最新版本 (支持最新 API)
- **langchain**: 最新版本
- **langchain-openai**: 最新版本
- **tiktoken**: 最新版本

### 5. 开发辅助工具 (升级中)
- **jupyter**: 最新版本
- **ipython**: 最新版本
- **notebook**: 最新版本
- **black**: 最新版本 (代码格式化)
- **pytest**: 最新版本 (测试框架)
- **pydantic**: 最新版本 (数据验证)
- **tqdm**: 最新版本 (进度条)
- **rich**: 最新版本 (终端美化)

---

## 使用方法

### 方法 1: 使用批处理脚本 (推荐)
```bash
upgrade_all.bat
```

### 方法 2: 使用 Python 脚本
```bash
python upgrade_local_packages.py
```

### 方法 3: 手动升级
```bash
# 升级单个包
pip install --upgrade <package_name>

# 升级多个包
pip install --upgrade numpy pandas scikit-learn

# 查看可更新的包
pip list --outdated
```

---

## 检查已安装版本

```bash
# 使用检查脚本
python check_versions.py

# 或使用 pip
pip list | grep <package_name>
pip show <package_name>
```

---

## 注意事项

### 1. NumPy 2.x 变更
**重要**: NumPy 从 1.x 升级到 2.x 有重大变更：
- API 变化
- 性能提升
- 可能影响依赖 NumPy 的库

如果遇到兼容性问题，可以降级：
```bash
pip install numpy<2.0
```

### 2. PyTorch 和 CUDA
**PyTorch 需要根据 CUDA 版本选择：**

```bash
# CPU 版本
pip install torch torchvision torchaudio

# CUDA 11.8
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118

# CUDA 12.1
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

### 3. TensorFlow 安装
```bash
# CPU 版本
pip install tensorflow

# GPU 版本 (需要 CUDA 和 cuDNN)
pip install tensorflow[and-cuda]
```

### 4. OpenAI SDK 重大更新
**OpenAI SDK 1.x+ 使用新 API：**

```python
# 新版 API (1.x+)
from openai import OpenAI

client = OpenAI(api_key="your-key")
response = client.chat.completions.create(
    model="gpt-4",
    messages=[{"role": "user", "content": "Hello"}]
)

# 旧版 API (0.x) - 已弃用
import openai
openai.api_key = "your-key"
response = openai.ChatCompletion.create(...)
```

---

## 常见问题

### Q1: 升级后某些包不兼容怎么办？
```bash
# 降级到特定版本
pip install package_name==old_version

# 查看版本历史
pip index versions package_name
```

### Q2: 如何创建虚拟环境？
```bash
# 创建虚拟环境
python -m venv venv

# 激活 (Windows)
venv\Scripts\activate

# 激活 (Linux/Mac)
source venv/bin/activate

# 在虚拟环境中安装
pip install -r requirements.txt
```

### Q3: 升级失败怎么办？
```bash
# 清理缓存
pip cache purge

# 使用国内镜像源
pip install --upgrade package_name -i https://pypi.tuna.tsinghua.edu.cn/simple

# 跳过依赖检查 (谨慎使用)
pip install --upgrade package_name --no-deps
```

---

## 推荐的国内镜像源

### 临时使用
```bash
pip install package_name -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 永久配置
创建/编辑 `~/.pip/pip.conf` (Linux/Mac) 或 `%APPDATA%\pip\pip.ini` (Windows):

```ini
[global]
index-url = https://pypi.tuna.tsinghua.edu.cn/simple

[install]
trusted-host = pypi.tuna.tsinghua.edu.cn
```

**常用镜像源：**
- 清华: https://pypi.tuna.tsinghua.edu.cn/simple
- 阿里云: https://mirrors.aliyun.com/pypi/simple
- 中科大: https://pypi.mirrors.ustc.edu.cn/simple
- 豆瓣: https://pypi.douban.com/simple

---

## 升级后测试

```bash
# 运行测试
python -c "import numpy; print('NumPy:', numpy.__version__)"
python -c "import pandas; print('Pandas:', pandas.__version__)"
python -c "import torch; print('PyTorch:', torch.__version__)"
python -c "import openai; print('OpenAI:', openai.__version__)"

# 或使用检查脚本
python check_versions.py
```

---

## 相关资源

- **PyPI 官网**: https://pypi.org/
- **NumPy 文档**: https://numpy.org/doc/
- **Pandas 文档**: https://pandas.pydata.org/docs/
- **PyTorch 文档**: https://pytorch.org/docs/
- **TensorFlow 文档**: https://www.tensorflow.org/
- **OpenAI API 文档**: https://platform.openai.com/docs/
- **LangChain 文档**: https://python.langchain.com/docs/

---

**最后更新**: 2025-12-05
**状态**: 升级进行中
